import{r as rt,d as it,c as z,e as Xt,T as _e,U as or,g as lr,q as ur,S as zt,f as S,K as Zt,V as dr,D as je,B as cr,J as hr,F as fr,X as oe,n as pr,Y as ot,x as gr,Z as mr,$ as yr,m as Ae,i as wr,C as lt,p as br,A as q,h as vr,l as Ve,k as De,W as Re,a0 as _r,j as ut}from"./base.esm-93c22595.js";import{_ as Sr}from"./objectWithoutPropertiesLoose-4f48578a.js";import{r as Cr,a as Er}from"./browser-b8405077.js";import{i as Tr,d as Ar}from"./index-cb656983.js";import{B as Dr}from"./baseEvmAdapter.esm-3afe8d13.js";function Rr(o,e){if(o==null)return{};var t=Sr(o,e),r,s;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);for(s=0;s<a.length;s++)r=a[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(o,r)&&(t[r]=o[r])}return t}var Ke={},he={},dt;function Or(){if(dt)return he;dt=1,Object.defineProperty(he,"__esModule",{value:!0}),he.storeAsStream=void 0;const o=rt;class e extends o.Duplex{constructor(s){super({objectMode:!0}),this.resume(),this.handler=a=>this.push(a),this.obsStore=s,this.obsStore.subscribe(this.handler)}pipe(s,a){const l=super.pipe(s,a);return s.write(this.obsStore.getState()),l}_write(s,a,l){this.obsStore.putState(s),l()}_read(s){}_destroy(s,a){this.obsStore.unsubscribe(this.handler),super._destroy(s,a)}}function t(r){return new e(r)}return he.storeAsStream=t,he}var fe={},pe={},Oe={},ct;function Ir(){if(ct)return Oe;ct=1,Object.defineProperty(Oe,"__esModule",{value:!0});const o=it();function e(s,a,l){try{Reflect.apply(s,a,l)}catch(u){setTimeout(()=>{throw u})}}function t(s){const a=s.length,l=new Array(a);for(let u=0;u<a;u+=1)l[u]=s[u];return l}class r extends o.EventEmitter{emit(a,...l){let u=a==="error";const h=this._events;if(h!==void 0)u=u&&h.error===void 0;else if(!u)return!1;if(u){let w;if(l.length>0&&([w]=l),w instanceof Error)throw w;const m=new Error(`Unhandled error.${w?` (${w.message})`:""}`);throw m.context=w,m}const g=h[a];if(g===void 0)return!1;if(typeof g=="function")e(g,this,l);else{const w=g.length,m=t(g);for(let T=0;T<w;T+=1)e(m[T],this,l)}return!0}}return Oe.default=r,Oe}var ht;function nt(){if(ht)return pe;ht=1;var o=z&&z.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(pe,"__esModule",{value:!0}),pe.ObservableStore=void 0;const e=o(Ir());let t=class extends e.default{constructor(s){super(),s?this._state=s:this._state={}}getState(){return this._getState()}putState(s){this._putState(s),this.emit("update",s)}updateState(s){if(s&&typeof s=="object"){const a=this.getState();this.putState(Object.assign(Object.assign({},a),s))}else this.putState(s)}subscribe(s){this.on("update",s)}unsubscribe(s){this.removeListener("update",s)}_getState(){return this._state}_putState(s){this._state=s}};return pe.ObservableStore=t,pe}var ft;function Pr(){if(ft)return fe;ft=1,Object.defineProperty(fe,"__esModule",{value:!0}),fe.ComposedStore=void 0;const o=nt();let e=class extends o.ObservableStore{constructor(r){super({}),this._children=r||{},Object.keys(this._children).forEach(s=>{const a=this._children[s];this._addChild(s,a)})}_addChild(r,s){const a=l=>{const u=this.getState();u[r]=l,this.putState(u)};s.subscribe(a),a(s.getState())}};return fe.ComposedStore=e,fe}var ge={},pt;function Mr(){if(pt)return ge;pt=1,Object.defineProperty(ge,"__esModule",{value:!0}),ge.MergedStore=void 0;const o=nt();let e=class extends o.ObservableStore{constructor(r=[]){super({}),this._children=r,r.forEach(s=>this._addChild(s)),this._updateWholeState()}_addChild(r){r.subscribe(()=>this._updateWholeState())}_updateWholeState(){const r=this._children.map(a=>a.getState()),s=Object.assign({},...r);this.putState(s)}};return ge.MergedStore=e,ge}var me={},le={},Nr={get exports(){return le},set exports(o){le=o}},be={},Lr={get exports(){return be},set exports(o){be=o}},Ie={},gt={get exports(){return Ie},set exports(o){Ie=o}},mt;function Me(){if(mt)return Ie;mt=1,typeof process>"u"||!process.version||process.version.indexOf("v0.")===0||process.version.indexOf("v1.")===0&&process.version.indexOf("v1.8.")!==0?gt.exports={nextTick:o}:gt.exports=process;function o(e,t,r,s){if(typeof e!="function")throw new TypeError('"callback" argument must be a function');var a=arguments.length,l,u;switch(a){case 0:case 1:return process.nextTick(e);case 2:return process.nextTick(function(){e.call(null,t)});case 3:return process.nextTick(function(){e.call(null,t,r)});case 4:return process.nextTick(function(){e.call(null,t,r,s)});default:for(l=new Array(a-1),u=0;u<l.length;)l[u++]=arguments[u];return process.nextTick(function(){e.apply(null,l)})}}return Ie}var Fe,yt;function xr(){if(yt)return Fe;yt=1;var o={}.toString;return Fe=Array.isArray||function(e){return o.call(e)=="[object Array]"},Fe}var Ge,wt;function Jt(){return wt||(wt=1,Ge=it().EventEmitter),Ge}var ve={},Ur={get exports(){return ve},set exports(o){ve=o}},bt;function Ne(){return bt||(bt=1,function(o,e){var t=Xt(),r=t.Buffer;function s(l,u){for(var h in l)u[h]=l[h]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?o.exports=t:(s(t,e),e.Buffer=a);function a(l,u,h){return r(l,u,h)}s(r,a),a.from=function(l,u,h){if(typeof l=="number")throw new TypeError("Argument must not be a number");return r(l,u,h)},a.alloc=function(l,u,h){if(typeof l!="number")throw new TypeError("Argument must be a number");var g=r(l);return u!==void 0?typeof h=="string"?g.fill(u,h):g.fill(u):g.fill(0),g},a.allocUnsafe=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return r(l)},a.allocUnsafeSlow=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(l)}}(Ur,ve)),ve}var B={},vt;function Se(){if(vt)return B;vt=1;function o(v){return Array.isArray?Array.isArray(v):D(v)==="[object Array]"}B.isArray=o;function e(v){return typeof v=="boolean"}B.isBoolean=e;function t(v){return v===null}B.isNull=t;function r(v){return v==null}B.isNullOrUndefined=r;function s(v){return typeof v=="number"}B.isNumber=s;function a(v){return typeof v=="string"}B.isString=a;function l(v){return typeof v=="symbol"}B.isSymbol=l;function u(v){return v===void 0}B.isUndefined=u;function h(v){return D(v)==="[object RegExp]"}B.isRegExp=h;function g(v){return typeof v=="object"&&v!==null}B.isObject=g;function w(v){return D(v)==="[object Date]"}B.isDate=w;function m(v){return D(v)==="[object Error]"||v instanceof Error}B.isError=m;function T(v){return typeof v=="function"}B.isFunction=T;function M(v){return v===null||typeof v=="boolean"||typeof v=="number"||typeof v=="string"||typeof v=="symbol"||typeof v>"u"}B.isPrimitive=M,B.isBuffer=Xt().Buffer.isBuffer;function D(v){return Object.prototype.toString.call(v)}return B}var Pe={},kr={get exports(){return Pe},set exports(o){Pe=o}},_t;function Br(){return _t||(_t=1,function(o){function e(a,l){if(!(a instanceof l))throw new TypeError("Cannot call a class as a function")}var t=Ne().Buffer,r=rt;function s(a,l,u){a.copy(l,u)}o.exports=function(){function a(){e(this,a),this.head=null,this.tail=null,this.length=0}return a.prototype.push=function(u){var h={data:u,next:null};this.length>0?this.tail.next=h:this.head=h,this.tail=h,++this.length},a.prototype.unshift=function(u){var h={data:u,next:this.head};this.length===0&&(this.tail=h),this.head=h,++this.length},a.prototype.shift=function(){if(this.length!==0){var u=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,u}},a.prototype.clear=function(){this.head=this.tail=null,this.length=0},a.prototype.join=function(u){if(this.length===0)return"";for(var h=this.head,g=""+h.data;h=h.next;)g+=u+h.data;return g},a.prototype.concat=function(u){if(this.length===0)return t.alloc(0);if(this.length===1)return this.head.data;for(var h=t.allocUnsafe(u>>>0),g=this.head,w=0;g;)s(g.data,h,w),w+=g.data.length,g=g.next;return h},a}(),r&&r.inspect&&r.inspect.custom&&(o.exports.prototype[r.inspect.custom]=function(){var a=r.inspect({length:this.length});return this.constructor.name+" "+a})}(kr)),Pe}var Ye,St;function Qt(){if(St)return Ye;St=1;var o=Me();function e(s,a){var l=this,u=this._readableState&&this._readableState.destroyed,h=this._writableState&&this._writableState.destroyed;return u||h?(a?a(s):s&&(!this._writableState||!this._writableState.errorEmitted)&&o.nextTick(r,this,s),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(s||null,function(g){!a&&g?(o.nextTick(r,l,g),l._writableState&&(l._writableState.errorEmitted=!0)):a&&a(g)}),this)}function t(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function r(s,a){s.emit("error",a)}return Ye={destroy:e,undestroy:t},Ye}var $e,Ct;function er(){if(Ct)return $e;Ct=1;var o=Me();$e=v;function e(d){var c=this;this.next=null,this.entry=null,this.finish=function(){Ue(c,d)}}var t=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:o.nextTick,r;v.WritableState=M;var s=Object.create(Se());s.inherits=_e();var a={deprecate:or()},l=Jt(),u=Ne().Buffer,h=z.Uint8Array||function(){};function g(d){return u.from(d)}function w(d){return u.isBuffer(d)||d instanceof h}var m=Qt();s.inherits(v,l);function T(){}function M(d,c){r=r||ue(),d=d||{};var y=c instanceof r;this.objectMode=!!d.objectMode,y&&(this.objectMode=this.objectMode||!!d.writableObjectMode);var C=d.highWaterMark,O=d.writableHighWaterMark,P=this.objectMode?16:16*1024;C||C===0?this.highWaterMark=C:y&&(O||O===0)?this.highWaterMark=O:this.highWaterMark=P,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var j=d.decodeStrings===!1;this.decodeStrings=!j,this.defaultEncoding=d.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(V){$(c,V)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new e(this)}M.prototype.getBuffer=function(){for(var c=this.bufferedRequest,y=[];c;)y.push(c),c=c.next;return y},function(){try{Object.defineProperty(M.prototype,"buffer",{get:a.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var D;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(D=Function.prototype[Symbol.hasInstance],Object.defineProperty(v,Symbol.hasInstance,{value:function(d){return D.call(this,d)?!0:this!==v?!1:d&&d._writableState instanceof M}})):D=function(d){return d instanceof this};function v(d){if(r=r||ue(),!D.call(v,this)&&!(this instanceof r))return new v(d);this._writableState=new M(d,this),this.writable=!0,d&&(typeof d.write=="function"&&(this._write=d.write),typeof d.writev=="function"&&(this._writev=d.writev),typeof d.destroy=="function"&&(this._destroy=d.destroy),typeof d.final=="function"&&(this._final=d.final)),l.call(this)}v.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function W(d,c){var y=new Error("write after end");d.emit("error",y),o.nextTick(c,y)}function f(d,c,y,C){var O=!0,P=!1;return y===null?P=new TypeError("May not write null values to stream"):typeof y!="string"&&y!==void 0&&!c.objectMode&&(P=new TypeError("Invalid non-string/buffer chunk")),P&&(d.emit("error",P),o.nextTick(C,P),O=!1),O}v.prototype.write=function(d,c,y){var C=this._writableState,O=!1,P=!C.objectMode&&w(d);return P&&!u.isBuffer(d)&&(d=g(d)),typeof c=="function"&&(y=c,c=null),P?c="buffer":c||(c=C.defaultEncoding),typeof y!="function"&&(y=T),C.ended?W(this,y):(P||f(this,C,d,y))&&(C.pendingcb++,O=A(this,C,P,d,c,y)),O},v.prototype.cork=function(){var d=this._writableState;d.corked++},v.prototype.uncork=function(){var d=this._writableState;d.corked&&(d.corked--,!d.writing&&!d.corked&&!d.finished&&!d.bufferProcessing&&d.bufferedRequest&&ne(this,d))},v.prototype.setDefaultEncoding=function(c){if(typeof c=="string"&&(c=c.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((c+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+c);return this._writableState.defaultEncoding=c,this};function b(d,c,y){return!d.objectMode&&d.decodeStrings!==!1&&typeof c=="string"&&(c=u.from(c,y)),c}Object.defineProperty(v.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function A(d,c,y,C,O,P){if(!y){var j=b(c,C,O);C!==j&&(y=!0,O="buffer",C=j)}var V=c.objectMode?1:C.length;c.length+=V;var J=c.length<c.highWaterMark;if(J||(c.needDrain=!0),c.writing||c.corked){var Q=c.lastBufferedRequest;c.lastBufferedRequest={chunk:C,encoding:O,isBuf:y,callback:P,next:null},Q?Q.next=c.lastBufferedRequest:c.bufferedRequest=c.lastBufferedRequest,c.bufferedRequestCount+=1}else x(d,c,!1,V,C,O,P);return J}function x(d,c,y,C,O,P,j){c.writelen=C,c.writecb=j,c.writing=!0,c.sync=!0,y?d._writev(O,c.onwrite):d._write(O,P,c.onwrite),c.sync=!1}function L(d,c,y,C,O){--c.pendingcb,y?(o.nextTick(O,C),o.nextTick(Z,d,c),d._writableState.errorEmitted=!0,d.emit("error",C)):(O(C),d._writableState.errorEmitted=!0,d.emit("error",C),Z(d,c))}function Y(d){d.writing=!1,d.writecb=null,d.length-=d.writelen,d.writelen=0}function $(d,c){var y=d._writableState,C=y.sync,O=y.writecb;if(Y(y),c)L(d,y,C,c,O);else{var P=K(y);!P&&!y.corked&&!y.bufferProcessing&&y.bufferedRequest&&ne(d,y),C?t(X,d,y,P,O):X(d,y,P,O)}}function X(d,c,y,C){y||ie(d,c),c.pendingcb--,C(),Z(d,c)}function ie(d,c){c.length===0&&c.needDrain&&(c.needDrain=!1,d.emit("drain"))}function ne(d,c){c.bufferProcessing=!0;var y=c.bufferedRequest;if(d._writev&&y&&y.next){var C=c.bufferedRequestCount,O=new Array(C),P=c.corkedRequestsFree;P.entry=y;for(var j=0,V=!0;y;)O[j]=y,y.isBuf||(V=!1),y=y.next,j+=1;O.allBuffers=V,x(d,c,!0,c.length,O,"",P.finish),c.pendingcb++,c.lastBufferedRequest=null,P.next?(c.corkedRequestsFree=P.next,P.next=null):c.corkedRequestsFree=new e(c),c.bufferedRequestCount=0}else{for(;y;){var J=y.chunk,Q=y.encoding,i=y.callback,n=c.objectMode?1:J.length;if(x(d,c,!1,n,J,Q,i),y=y.next,c.bufferedRequestCount--,c.writing)break}y===null&&(c.lastBufferedRequest=null)}c.bufferedRequest=y,c.bufferProcessing=!1}v.prototype._write=function(d,c,y){y(new Error("_write() is not implemented"))},v.prototype._writev=null,v.prototype.end=function(d,c,y){var C=this._writableState;typeof d=="function"?(y=d,d=null,c=null):typeof c=="function"&&(y=c,c=null),d!=null&&this.write(d,c),C.corked&&(C.corked=1,this.uncork()),!C.ending&&!C.finished&&xe(this,C,y)};function K(d){return d.ending&&d.length===0&&d.bufferedRequest===null&&!d.finished&&!d.writing}function Ce(d,c){d._final(function(y){c.pendingcb--,y&&d.emit("error",y),c.prefinished=!0,d.emit("prefinish"),Z(d,c)})}function Ee(d,c){!c.prefinished&&!c.finalCalled&&(typeof d._final=="function"?(c.pendingcb++,c.finalCalled=!0,o.nextTick(Ce,d,c)):(c.prefinished=!0,d.emit("prefinish")))}function Z(d,c){var y=K(c);return y&&(Ee(d,c),c.pendingcb===0&&(c.finished=!0,d.emit("finish"))),y}function xe(d,c,y){c.ending=!0,Z(d,c),y&&(c.finished?o.nextTick(y):d.once("finish",y)),c.ended=!0,d.writable=!1}function Ue(d,c,y){var C=d.entry;for(d.entry=null;C;){var O=C.callback;c.pendingcb--,O(y),C=C.next}c.corkedRequestsFree?c.corkedRequestsFree.next=d:c.corkedRequestsFree=d}return Object.defineProperty(v.prototype,"destroyed",{get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(d){this._writableState&&(this._writableState.destroyed=d)}}),v.prototype.destroy=m.destroy,v.prototype._undestroy=m.undestroy,v.prototype._destroy=function(d,c){this.end(),c(d)},$e}var Xe,Et;function ue(){if(Et)return Xe;Et=1;var o=Me(),e=Object.keys||function(m){var T=[];for(var M in m)T.push(M);return T};Xe=h;var t=Object.create(Se());t.inherits=_e();var r=tr(),s=er();t.inherits(h,r);for(var a=e(s.prototype),l=0;l<a.length;l++){var u=a[l];h.prototype[u]||(h.prototype[u]=s.prototype[u])}function h(m){if(!(this instanceof h))return new h(m);r.call(this,m),s.call(this,m),m&&m.readable===!1&&(this.readable=!1),m&&m.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,m&&m.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",g)}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function g(){this.allowHalfOpen||this._writableState.ended||o.nextTick(w,this)}function w(m){m.end()}return Object.defineProperty(h.prototype,"destroyed",{get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(m){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=m,this._writableState.destroyed=m)}}),h.prototype._destroy=function(m,T){this.push(null),this.end(),o.nextTick(T,m)},Xe}var ze={},Tt;function At(){if(Tt)return ze;Tt=1;var o=Ne().Buffer,e=o.isEncoding||function(f){switch(f=""+f,f&&f.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function t(f){if(!f)return"utf8";for(var b;;)switch(f){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return f;default:if(b)return;f=(""+f).toLowerCase(),b=!0}}function r(f){var b=t(f);if(typeof b!="string"&&(o.isEncoding===e||!e(f)))throw new Error("Unknown encoding: "+f);return b||f}ze.StringDecoder=s;function s(f){this.encoding=r(f);var b;switch(this.encoding){case"utf16le":this.text=m,this.end=T,b=4;break;case"utf8":this.fillLast=h,b=4;break;case"base64":this.text=M,this.end=D,b=3;break;default:this.write=v,this.end=W;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=o.allocUnsafe(b)}s.prototype.write=function(f){if(f.length===0)return"";var b,A;if(this.lastNeed){if(b=this.fillLast(f),b===void 0)return"";A=this.lastNeed,this.lastNeed=0}else A=0;return A<f.length?b?b+this.text(f,A):this.text(f,A):b||""},s.prototype.end=w,s.prototype.text=g,s.prototype.fillLast=function(f){if(this.lastNeed<=f.length)return f.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);f.copy(this.lastChar,this.lastTotal-this.lastNeed,0,f.length),this.lastNeed-=f.length};function a(f){return f<=127?0:f>>5===6?2:f>>4===14?3:f>>3===30?4:f>>6===2?-1:-2}function l(f,b,A){var x=b.length-1;if(x<A)return 0;var L=a(b[x]);return L>=0?(L>0&&(f.lastNeed=L-1),L):--x<A||L===-2?0:(L=a(b[x]),L>=0?(L>0&&(f.lastNeed=L-2),L):--x<A||L===-2?0:(L=a(b[x]),L>=0?(L>0&&(L===2?L=0:f.lastNeed=L-3),L):0))}function u(f,b,A){if((b[0]&192)!==128)return f.lastNeed=0,"�";if(f.lastNeed>1&&b.length>1){if((b[1]&192)!==128)return f.lastNeed=1,"�";if(f.lastNeed>2&&b.length>2&&(b[2]&192)!==128)return f.lastNeed=2,"�"}}function h(f){var b=this.lastTotal-this.lastNeed,A=u(this,f);if(A!==void 0)return A;if(this.lastNeed<=f.length)return f.copy(this.lastChar,b,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);f.copy(this.lastChar,b,0,f.length),this.lastNeed-=f.length}function g(f,b){var A=l(this,f,b);if(!this.lastNeed)return f.toString("utf8",b);this.lastTotal=A;var x=f.length-(A-this.lastNeed);return f.copy(this.lastChar,0,x),f.toString("utf8",b,x)}function w(f){var b=f&&f.length?this.write(f):"";return this.lastNeed?b+"�":b}function m(f,b){if((f.length-b)%2===0){var A=f.toString("utf16le",b);if(A){var x=A.charCodeAt(A.length-1);if(x>=55296&&x<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=f[f.length-2],this.lastChar[1]=f[f.length-1],A.slice(0,-1)}return A}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=f[f.length-1],f.toString("utf16le",b,f.length-1)}function T(f){var b=f&&f.length?this.write(f):"";if(this.lastNeed){var A=this.lastTotal-this.lastNeed;return b+this.lastChar.toString("utf16le",0,A)}return b}function M(f,b){var A=(f.length-b)%3;return A===0?f.toString("base64",b):(this.lastNeed=3-A,this.lastTotal=3,A===1?this.lastChar[0]=f[f.length-1]:(this.lastChar[0]=f[f.length-2],this.lastChar[1]=f[f.length-1]),f.toString("base64",b,f.length-A))}function D(f){var b=f&&f.length?this.write(f):"";return this.lastNeed?b+this.lastChar.toString("base64",0,3-this.lastNeed):b}function v(f){return f.toString(this.encoding)}function W(f){return f&&f.length?this.write(f):""}return ze}var Ze,Dt;function tr(){if(Dt)return Ze;Dt=1;var o=Me();Ze=b;var e=xr(),t;b.ReadableState=f,it().EventEmitter;var r=function(i,n){return i.listeners(n).length},s=Jt(),a=Ne().Buffer,l=z.Uint8Array||function(){};function u(i){return a.from(i)}function h(i){return a.isBuffer(i)||i instanceof l}var g=Object.create(Se());g.inherits=_e();var w=rt,m=void 0;w&&w.debuglog?m=w.debuglog("stream"):m=function(){};var T=Br(),M=Qt(),D;g.inherits(b,s);var v=["error","close","destroy","pause","resume"];function W(i,n,p){if(typeof i.prependListener=="function")return i.prependListener(n,p);!i._events||!i._events[n]?i.on(n,p):e(i._events[n])?i._events[n].unshift(p):i._events[n]=[p,i._events[n]]}function f(i,n){t=t||ue(),i=i||{};var p=n instanceof t;this.objectMode=!!i.objectMode,p&&(this.objectMode=this.objectMode||!!i.readableObjectMode);var _=i.highWaterMark,I=i.readableHighWaterMark,E=this.objectMode?16:16*1024;_||_===0?this.highWaterMark=_:p&&(I||I===0)?this.highWaterMark=I:this.highWaterMark=E,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new T,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=i.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,i.encoding&&(D||(D=At().StringDecoder),this.decoder=new D(i.encoding),this.encoding=i.encoding)}function b(i){if(t=t||ue(),!(this instanceof b))return new b(i);this._readableState=new f(i,this),this.readable=!0,i&&(typeof i.read=="function"&&(this._read=i.read),typeof i.destroy=="function"&&(this._destroy=i.destroy)),s.call(this)}Object.defineProperty(b.prototype,"destroyed",{get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(i){this._readableState&&(this._readableState.destroyed=i)}}),b.prototype.destroy=M.destroy,b.prototype._undestroy=M.undestroy,b.prototype._destroy=function(i,n){this.push(null),n(i)},b.prototype.push=function(i,n){var p=this._readableState,_;return p.objectMode?_=!0:typeof i=="string"&&(n=n||p.defaultEncoding,n!==p.encoding&&(i=a.from(i,n),n=""),_=!0),A(this,i,n,!1,_)},b.prototype.unshift=function(i){return A(this,i,null,!0,!1)};function A(i,n,p,_,I){var E=i._readableState;if(n===null)E.reading=!1,ne(i,E);else{var R;I||(R=L(E,n)),R?i.emit("error",R):E.objectMode||n&&n.length>0?(typeof n!="string"&&!E.objectMode&&Object.getPrototypeOf(n)!==a.prototype&&(n=u(n)),_?E.endEmitted?i.emit("error",new Error("stream.unshift() after end event")):x(i,E,n,!0):E.ended?i.emit("error",new Error("stream.push() after EOF")):(E.reading=!1,E.decoder&&!p?(n=E.decoder.write(n),E.objectMode||n.length!==0?x(i,E,n,!1):Ee(i,E)):x(i,E,n,!1))):_||(E.reading=!1)}return Y(E)}function x(i,n,p,_){n.flowing&&n.length===0&&!n.sync?(i.emit("data",p),i.read(0)):(n.length+=n.objectMode?1:p.length,_?n.buffer.unshift(p):n.buffer.push(p),n.needReadable&&K(i)),Ee(i,n)}function L(i,n){var p;return!h(n)&&typeof n!="string"&&n!==void 0&&!i.objectMode&&(p=new TypeError("Invalid non-string/buffer chunk")),p}function Y(i){return!i.ended&&(i.needReadable||i.length<i.highWaterMark||i.length===0)}b.prototype.isPaused=function(){return this._readableState.flowing===!1},b.prototype.setEncoding=function(i){return D||(D=At().StringDecoder),this._readableState.decoder=new D(i),this._readableState.encoding=i,this};var $=8388608;function X(i){return i>=$?i=$:(i--,i|=i>>>1,i|=i>>>2,i|=i>>>4,i|=i>>>8,i|=i>>>16,i++),i}function ie(i,n){return i<=0||n.length===0&&n.ended?0:n.objectMode?1:i!==i?n.flowing&&n.length?n.buffer.head.data.length:n.length:(i>n.highWaterMark&&(n.highWaterMark=X(i)),i<=n.length?i:n.ended?n.length:(n.needReadable=!0,0))}b.prototype.read=function(i){m("read",i),i=parseInt(i,10);var n=this._readableState,p=i;if(i!==0&&(n.emittedReadable=!1),i===0&&n.needReadable&&(n.length>=n.highWaterMark||n.ended))return m("read: emitReadable",n.length,n.ended),n.length===0&&n.ended?V(this):K(this),null;if(i=ie(i,n),i===0&&n.ended)return n.length===0&&V(this),null;var _=n.needReadable;m("need readable",_),(n.length===0||n.length-i<n.highWaterMark)&&(_=!0,m("length less than watermark",_)),n.ended||n.reading?(_=!1,m("reading or ended",_)):_&&(m("do read"),n.reading=!0,n.sync=!0,n.length===0&&(n.needReadable=!0),this._read(n.highWaterMark),n.sync=!1,n.reading||(i=ie(p,n)));var I;return i>0?I=C(i,n):I=null,I===null?(n.needReadable=!0,i=0):n.length-=i,n.length===0&&(n.ended||(n.needReadable=!0),p!==i&&n.ended&&V(this)),I!==null&&this.emit("data",I),I};function ne(i,n){if(!n.ended){if(n.decoder){var p=n.decoder.end();p&&p.length&&(n.buffer.push(p),n.length+=n.objectMode?1:p.length)}n.ended=!0,K(i)}}function K(i){var n=i._readableState;n.needReadable=!1,n.emittedReadable||(m("emitReadable",n.flowing),n.emittedReadable=!0,n.sync?o.nextTick(Ce,i):Ce(i))}function Ce(i){m("emit readable"),i.emit("readable"),y(i)}function Ee(i,n){n.readingMore||(n.readingMore=!0,o.nextTick(Z,i,n))}function Z(i,n){for(var p=n.length;!n.reading&&!n.flowing&&!n.ended&&n.length<n.highWaterMark&&(m("maybeReadMore read 0"),i.read(0),p!==n.length);)p=n.length;n.readingMore=!1}b.prototype._read=function(i){this.emit("error",new Error("_read() is not implemented"))},b.prototype.pipe=function(i,n){var p=this,_=this._readableState;switch(_.pipesCount){case 0:_.pipes=i;break;case 1:_.pipes=[_.pipes,i];break;default:_.pipes.push(i);break}_.pipesCount+=1,m("pipe count=%d opts=%j",_.pipesCount,n);var I=(!n||n.end!==!1)&&i!==process.stdout&&i!==process.stderr,E=I?Te:de;_.endEmitted?o.nextTick(E):p.once("end",E),i.on("unpipe",R);function R(se,ce){m("onunpipe"),se===p&&ce&&ce.hasUnpiped===!1&&(ce.hasUnpiped=!0,ar())}function Te(){m("onend"),i.end()}var ke=xe(p);i.on("drain",ke);var st=!1;function ar(){m("cleanup"),i.removeListener("close",qe),i.removeListener("finish",He),i.removeListener("drain",ke),i.removeListener("error",We),i.removeListener("unpipe",R),p.removeListener("end",Te),p.removeListener("end",de),p.removeListener("data",at),st=!0,_.awaitDrain&&(!i._writableState||i._writableState.needDrain)&&ke()}var Be=!1;p.on("data",at);function at(se){m("ondata"),Be=!1;var ce=i.write(se);ce===!1&&!Be&&((_.pipesCount===1&&_.pipes===i||_.pipesCount>1&&Q(_.pipes,i)!==-1)&&!st&&(m("false write response, pause",p._readableState.awaitDrain),p._readableState.awaitDrain++,Be=!0),p.pause())}function We(se){m("onerror",se),de(),i.removeListener("error",We),r(i,"error")===0&&i.emit("error",se)}W(i,"error",We);function qe(){i.removeListener("finish",He),de()}i.once("close",qe);function He(){m("onfinish"),i.removeListener("close",qe),de()}i.once("finish",He);function de(){m("unpipe"),p.unpipe(i)}return i.emit("pipe",p),_.flowing||(m("pipe resume"),p.resume()),i};function xe(i){return function(){var n=i._readableState;m("pipeOnDrain",n.awaitDrain),n.awaitDrain&&n.awaitDrain--,n.awaitDrain===0&&r(i,"data")&&(n.flowing=!0,y(i))}}b.prototype.unpipe=function(i){var n=this._readableState,p={hasUnpiped:!1};if(n.pipesCount===0)return this;if(n.pipesCount===1)return i&&i!==n.pipes?this:(i||(i=n.pipes),n.pipes=null,n.pipesCount=0,n.flowing=!1,i&&i.emit("unpipe",this,p),this);if(!i){var _=n.pipes,I=n.pipesCount;n.pipes=null,n.pipesCount=0,n.flowing=!1;for(var E=0;E<I;E++)_[E].emit("unpipe",this,p);return this}var R=Q(n.pipes,i);return R===-1?this:(n.pipes.splice(R,1),n.pipesCount-=1,n.pipesCount===1&&(n.pipes=n.pipes[0]),i.emit("unpipe",this,p),this)},b.prototype.on=function(i,n){var p=s.prototype.on.call(this,i,n);if(i==="data")this._readableState.flowing!==!1&&this.resume();else if(i==="readable"){var _=this._readableState;!_.endEmitted&&!_.readableListening&&(_.readableListening=_.needReadable=!0,_.emittedReadable=!1,_.reading?_.length&&K(this):o.nextTick(Ue,this))}return p},b.prototype.addListener=b.prototype.on;function Ue(i){m("readable nexttick read 0"),i.read(0)}b.prototype.resume=function(){var i=this._readableState;return i.flowing||(m("resume"),i.flowing=!0,d(this,i)),this};function d(i,n){n.resumeScheduled||(n.resumeScheduled=!0,o.nextTick(c,i,n))}function c(i,n){n.reading||(m("resume read 0"),i.read(0)),n.resumeScheduled=!1,n.awaitDrain=0,i.emit("resume"),y(i),n.flowing&&!n.reading&&i.read(0)}b.prototype.pause=function(){return m("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(m("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function y(i){var n=i._readableState;for(m("flow",n.flowing);n.flowing&&i.read()!==null;);}b.prototype.wrap=function(i){var n=this,p=this._readableState,_=!1;i.on("end",function(){if(m("wrapped end"),p.decoder&&!p.ended){var R=p.decoder.end();R&&R.length&&n.push(R)}n.push(null)}),i.on("data",function(R){if(m("wrapped data"),p.decoder&&(R=p.decoder.write(R)),!(p.objectMode&&R==null)&&!(!p.objectMode&&(!R||!R.length))){var Te=n.push(R);Te||(_=!0,i.pause())}});for(var I in i)this[I]===void 0&&typeof i[I]=="function"&&(this[I]=function(R){return function(){return i[R].apply(i,arguments)}}(I));for(var E=0;E<v.length;E++)i.on(v[E],this.emit.bind(this,v[E]));return this._read=function(R){m("wrapped _read",R),_&&(_=!1,i.resume())},this},Object.defineProperty(b.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),b._fromList=C;function C(i,n){if(n.length===0)return null;var p;return n.objectMode?p=n.buffer.shift():!i||i>=n.length?(n.decoder?p=n.buffer.join(""):n.buffer.length===1?p=n.buffer.head.data:p=n.buffer.concat(n.length),n.buffer.clear()):p=O(i,n.buffer,n.decoder),p}function O(i,n,p){var _;return i<n.head.data.length?(_=n.head.data.slice(0,i),n.head.data=n.head.data.slice(i)):i===n.head.data.length?_=n.shift():_=p?P(i,n):j(i,n),_}function P(i,n){var p=n.head,_=1,I=p.data;for(i-=I.length;p=p.next;){var E=p.data,R=i>E.length?E.length:i;if(R===E.length?I+=E:I+=E.slice(0,i),i-=R,i===0){R===E.length?(++_,p.next?n.head=p.next:n.head=n.tail=null):(n.head=p,p.data=E.slice(R));break}++_}return n.length-=_,I}function j(i,n){var p=a.allocUnsafe(i),_=n.head,I=1;for(_.data.copy(p),i-=_.data.length;_=_.next;){var E=_.data,R=i>E.length?E.length:i;if(E.copy(p,p.length-i,0,R),i-=R,i===0){R===E.length?(++I,_.next?n.head=_.next:n.head=n.tail=null):(n.head=_,_.data=E.slice(R));break}++I}return n.length-=I,p}function V(i){var n=i._readableState;if(n.length>0)throw new Error('"endReadable()" called on non-empty stream');n.endEmitted||(n.ended=!0,o.nextTick(J,n,i))}function J(i,n){!i.endEmitted&&i.length===0&&(i.endEmitted=!0,n.readable=!1,n.emit("end"))}function Q(i,n){for(var p=0,_=i.length;p<_;p++)if(i[p]===n)return p;return-1}return Ze}var Je,Rt;function rr(){if(Rt)return Je;Rt=1,Je=r;var o=ue(),e=Object.create(Se());e.inherits=_e(),e.inherits(r,o);function t(l,u){var h=this._transformState;h.transforming=!1;var g=h.writecb;if(!g)return this.emit("error",new Error("write callback called multiple times"));h.writechunk=null,h.writecb=null,u!=null&&this.push(u),g(l);var w=this._readableState;w.reading=!1,(w.needReadable||w.length<w.highWaterMark)&&this._read(w.highWaterMark)}function r(l){if(!(this instanceof r))return new r(l);o.call(this,l),this._transformState={afterTransform:t.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,l&&(typeof l.transform=="function"&&(this._transform=l.transform),typeof l.flush=="function"&&(this._flush=l.flush)),this.on("prefinish",s)}function s(){var l=this;typeof this._flush=="function"?this._flush(function(u,h){a(l,u,h)}):a(this,null,null)}r.prototype.push=function(l,u){return this._transformState.needTransform=!1,o.prototype.push.call(this,l,u)},r.prototype._transform=function(l,u,h){throw new Error("_transform() is not implemented")},r.prototype._write=function(l,u,h){var g=this._transformState;if(g.writecb=h,g.writechunk=l,g.writeencoding=u,!g.transforming){var w=this._readableState;(g.needTransform||w.needReadable||w.length<w.highWaterMark)&&this._read(w.highWaterMark)}},r.prototype._read=function(l){var u=this._transformState;u.writechunk!==null&&u.writecb&&!u.transforming?(u.transforming=!0,this._transform(u.writechunk,u.writeencoding,u.afterTransform)):u.needTransform=!0},r.prototype._destroy=function(l,u){var h=this;o.prototype._destroy.call(this,l,function(g){u(g),h.emit("close")})};function a(l,u,h){if(u)return l.emit("error",u);if(h!=null&&l.push(h),l._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(l._transformState.transforming)throw new Error("Calling transform done when still transforming");return l.push(null)}return Je}var Qe,Ot;function Wr(){if(Ot)return Qe;Ot=1,Qe=t;var o=rr(),e=Object.create(Se());e.inherits=_e(),e.inherits(t,o);function t(r){if(!(this instanceof t))return new t(r);o.call(this,r)}return t.prototype._transform=function(r,s,a){a(null,r)},Qe}var It;function qr(){return It||(It=1,function(o,e){e=o.exports=tr(),e.Stream=e,e.Readable=e,e.Writable=er(),e.Duplex=ue(),e.Transform=rr(),e.PassThrough=Wr()}(Lr,be)),be}var et,Pt;function Hr(){if(Pt)return et;Pt=1,et=e;var o=Object.prototype.hasOwnProperty;function e(){for(var t={},r=0;r<arguments.length;r++){var s=arguments[r];for(var a in s)o.call(s,a)&&(t[a]=s[a])}return t}return et}var Mt;function jr(){if(Mt)return le;Mt=1;var o=qr().Transform,e=Cr().inherits,t=Hr();function r(l){o.call(this,l),this._destroyed=!1}e(r,o),r.prototype.destroy=function(l){if(!this._destroyed){this._destroyed=!0;var u=this;process.nextTick(function(){l&&u.emit("error",l),u.emit("close")})}};function s(l,u,h){h(null,l)}function a(l){return function(u,h,g){return typeof u=="function"&&(g=h,h=u,u={}),typeof h!="function"&&(h=s),typeof g!="function"&&(g=null),l(u,h,g)}}return Nr.exports=a(function(l,u,h){var g=new r(l);return g._transform=u,h&&(g._flush=h),g}),le.ctor=a(function(l,u,h){function g(w){if(!(this instanceof g))return new g(w);this.options=t(l,w),r.call(this,this.options)}return e(g,r),g.prototype._transform=u,h&&(g.prototype._flush=h),g}),le.obj=a(function(l,u,h){var g=new r(t({objectMode:!0,highWaterMark:16},l));return g._transform=u,h&&(g._flush=h),g}),le}var Nt;function Vr(){if(Nt)return me;Nt=1,Object.defineProperty(me,"__esModule",{value:!0}),me.storeTransformStream=void 0;const o=jr();function e(t){return o.obj((r,s,a)=>{try{const l=t(r);a(null,l);return}catch(l){a(l);return}})}return me.storeTransformStream=e,me}var Lt;function Kr(){return Lt||(Lt=1,function(o){var e=z&&z.__createBinding||(Object.create?function(r,s,a,l){l===void 0&&(l=a),Object.defineProperty(r,l,{enumerable:!0,get:function(){return s[a]}})}:function(r,s,a,l){l===void 0&&(l=a),r[l]=s[a]}),t=z&&z.__exportStar||function(r,s){for(var a in r)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&e(s,r,a)};Object.defineProperty(o,"__esModule",{value:!0}),t(Or(),o),t(Pr(),o),t(Mr(),o),t(nt(),o),t(Vr(),o)}(Ke)),Ke}var xt=Kr(),Fr=Er();const Gr=lr(Fr),ye={GOOGLE:"google",FACEBOOK:"facebook",TWITCH:"twitch",REDDIT:"reddit",DISCORD:"discord"},te={GOOGLE:"google",FACEBOOK:"facebook",TWITCH:"twitch",REDDIT:"reddit",DISCORD:"discord",EMAIL_PASSWORDLESS:"torus-auth0-email-passwordless"},Ut={[te.GOOGLE]:"tkey-google",[te.FACEBOOK]:"tkey-facebook",[te.TWITCH]:"tkey-twitch",[te.REDDIT]:"tkey-reddit",[te.DISCORD]:"tkey-discord",[te.EMAIL_PASSWORDLESS]:"tkey-auth0-email-passwordless"},U={MOONPAY:"moonpay",WYRE:"wyre",RAMPNETWORK:"rampnetwork",XANPOOL:"xanpool",MERCURYO:"mercuryo",TRANSAK:"transak",BANXA:"banxa"},k={MAINNET:"mainnet",MATIC:"matic",BSC_MAINNET:"bsc_mainnet",AVALANCHE_MAINNET:"avalanche_mainnet",XDAI:"xdai"},Yr={PRODUCTION:"production",DEVELOPMENT:"development",BINANCE:"binance",TESTING:"testing",LRC:"lrc",BETA:"beta",BNB:"bnb",POLYGON:"polygon"},ae={BOTTOM_LEFT:"bottom-left",TOP_LEFT:"top-left",BOTTOM_RIGHT:"bottom-right",TOP_RIGHT:"top-right"},$r=["ETH","USDT","USDC","TUSD","EOSDT","USD","DAI","GUSD","DKKT","PAX","ILS","RUB","BYN","EUR","GBP","JPY","KRW","PLN","MXN","AUD","BRL","CAD","CHF","KPW","LAK","LBP","LKR","XOF","CNHT","DOGE","UAH","TRY","HKD","XJP","SGD","USC","NZD","NGN","RUR","COP","GHS","EGP","IDR","BHD","CRC","PEN","AED","DOP","PKR","HUF","VND","XAR","LTC","RON","OMR","MYR","DKK","UGX","ZMW","SAR","SEK","GEL","RWF","IRR","TZS","CNY","VEF","BDT","HRK","CLP","THB","XAF","ARS","UYU","SZL","KZT","NOK","KES","PAB","INR","CZK","MAD","TWD","PHP","ZAR","BOB","CDF","DASH","VES","ISK","MWK","BAM","TTD","XRP","JOD","RSD","HNL","BGN","GTQ","BWP","XMR","MMK","QAR","AOA","KWD","MUR","WUSD","WEUR","WAVES","WTRY","LRD","LSL","LYD","AWG","MDL","BTO","EURS","CHFT","MKD","MNT","MOP","MRO","MVR","VOLLAR","CKUSD","KHR","VUV","BITCNY","QC","BBD","NAD","NPR","PGK","PYG","BIF","BMD","BND","XLM","BNB","SCR","BAT","CRO","HT","KCS","LEO","LINK","MKR","NPXS","OMG","REP","ZB","ZIL","ZRX","BCH","BZD","CUP","CVE","DJF","DZD","ERN","ETB","FJD","FKP","BUSD","ANCT","ALL","AMD","ANG","CNYX","IQD","UZS","TND","GGP","XAU","KGS","GIP","JMD","ZEC","USDP","BSV","EMC2","SNT","GTO","POWR","EUSD","EURT","BCY","BTS","ATM","BLOCKPAY","ARDR","AMP","B2X","BITGOLD","BITEUR","ATB","BITUSD","AGRS","DFXT","HIKEN","BIX","KNC","EOS","COB","COSS","BMH","NANO","BDG","BNT","XVG","LKK1Y","LKK","USDK","EURN","NZDT","JSE","GMD","GNF","GYD","YER","XPF","HTG","SLL","SOS","WST","SVC","SYP","NEO","KMF","JUMP","AYA","BLAST","WGR","BCN","BTG","URALS","INN","USDQ","CNH","HUSD","BKRW","NZDX","EURX","CADX","USDEX","JPYX","AUDX","VNDC","EON","GBPX","CHFX","USDJ","IDRT","USDS","USDN","BIDR","IDK","BSD","BTN","KYD","NIO","SBD","SDG","SHP","TOP","XCD","XCHF","CNYT","GYEN","ZUSD","GOLD","TRX","TRYB","PLATC","STRAX","UST","GLM","VAI","BRZ","DDRST","XAUT","MIM"],Xr={[U.MOONPAY]:["AUD","BGN","BRL","CAD","CHF","CNY","COP","CZK","DKK","DOP","EGP","EUR","GBP","HKD","HRK","IDR","ILS","JPY","JOD","KES","KRW","KWD","LKR","MAD","MXN","MYR","NGN","NOK","NZD","OMR","PEN","PKR","PLN","RON","RUB","SEK","SGD","THB","TRY","TWD","USD","VND","ZAR"],[U.WYRE]:["USD","EUR","GBP","AUD","CAD","NZD","ARS","BRL","CHF","CLP","COP","CZK","DKK","HKD","ILS","INR","ISK","JPY","KRW","MXN","MYR","NOK","PHP","PLN","SEK","THB","VND","ZAR"],[U.RAMPNETWORK]:["USD","EUR","GBP"],[U.XANPOOL]:["SGD","HKD","THB","PHP","INR","IDR","MYR","AUD","NZD","KRW"],[U.MERCURYO]:["EUR","USD","GBP","TRY","JPY","BRL","NGN","VND","MXN","KRW"],[U.TRANSAK]:["ARS","AUD","BBD","BGN","BMD","BRL","CAD","CHF","CLP","CRC","CZK","DKK","DOP","EUR","FJD","FKP","GBP","GIP","HRK","HUF","IDR","ILS","ISK","JMD","JPY","KES","KRW","MDL","MXN","MYR","NOK","NZD","PEN","PHP","PLN","PYG","RON","SEK","SGD","THB","TRY","TZS","USD","ZAR"],[U.BANXA]:["EUR","GBP","USD"]},zr=new Set($r);function ee(o){return Xr[o].filter(t=>zr.has(t))}const Zr={[U.MOONPAY]:{line1:"Credit/ Debit Card/ Apple Pay",line2:"4.5% or 5 USD",line3:"2,000€/day, 10,000€/mo",supportPage:"https://help.moonpay.io/en/",minOrderValue:24.99,maxOrderValue:5e4,validCurrencies:ee(U.MOONPAY),validCryptoCurrenciesByChain:{[k.MAINNET]:[{value:"aave",display:"AAVE"},{value:"bat",display:"BAT"},{value:"dai",display:"DAI"},{value:"eth",display:"ETH"},{value:"mkr",display:"MKR"},{value:"matic",display:"MATIC"},{value:"usdt",display:"USDT"},{value:"usdc",display:"USDC"}],[k.MATIC]:[{value:"eth_polygon",display:"ETH"},{value:"matic_polygon",display:"MATIC"},{value:"usdc_polygon",display:"USDC"}],[k.BSC_MAINNET]:[{value:"bnb_bsc",display:"BNB"},{value:"busd_bsc",display:"BUSD"}],[k.AVALANCHE_MAINNET]:[{value:"avax_cchain",display:"AVAX"}]},includeFees:!0,api:!0,enforceMax:!1},[U.WYRE]:{line1:"Apple Pay/ Debit/ Credit Card",line2:"4.9% + 30¢ or 5 USD",line3:"$250/day",supportPage:"https://support.sendwyre.com/en/",minOrderValue:5,maxOrderValue:500,validCurrencies:ee(U.WYRE),validCryptoCurrenciesByChain:{[k.MAINNET]:[{value:"AAVE",display:"AAVE"},{value:"BAT",display:"BAT"},{value:"BUSD",display:"BUSD"},{value:"DAI",display:"DAI"},{value:"ETH",display:"ETH"},{value:"MKR",display:"MKR"},{value:"UNI",display:"UNI"},{value:"USDC",display:"USDC"},{value:"USDT",display:"USDT"}],[k.MATIC]:[{value:"MUSDC",display:"USDC"}],[k.AVALANCHE_MAINNET]:[{value:"AVAXC",display:"AVAXC"}]},includeFees:!1,api:!0,enforceMax:!1},[U.RAMPNETWORK]:{line1:"Debit Card/ <br>Apple Pay/ Bank transfer",line2:"0.49% - 2.9%",line3:"5,000€/purchase, 20,000€/mo",supportPage:"https://instant.ramp.network/",minOrderValue:50,maxOrderValue:2e4,validCurrencies:ee(U.RAMPNETWORK),validCryptoCurrenciesByChain:{[k.MAINNET]:[{value:"ETH",display:"ETH"},{value:"DAI",display:"DAI"},{value:"USDC",display:"USDC"},{value:"USDT",display:"USDT"}],[k.MATIC]:[{value:"MATIC_DAI",display:"DAI"},{value:"MATIC_MATIC",display:"MATIC"},{value:"MATIC_USDC",display:"USDC"}],[k.AVALANCHE_MAINNET]:[{value:"AVAX",display:"AVAX"}]},includeFees:!0,api:!0,receiveHint:"walletTopUp.receiveHintRamp",enforceMax:!1},[U.XANPOOL]:{line1:"PayNow/ InstaPay/ FPS/ GoJekPay/ UPI/ PromptPay/ <br>ViettelPay/ DuitNow",line2:"2.5% buying, 3% selling",line3:"$2,500 / day",supportPage:"mailto:support@xanpool.com",minOrderValue:100,maxOrderValue:2500,validCurrencies:ee(U.XANPOOL),validCryptoCurrenciesByChain:{[k.MAINNET]:[{value:"ETH",display:"ETH"},{value:"USDT",display:"USDT"}]},includeFees:!0,api:!0,sell:!0,enforceMax:!1},[U.MERCURYO]:{line1:"Credit/ Debit Card/ Apple Pay",line2:"3.95% or 4 USD",line3:"10,000€/day, 25,000€/mo",supportPage:"mailto:support@mercuryo.io",minOrderValue:30,maxOrderValue:5e3,validCurrencies:ee(U.MERCURYO),validCryptoCurrenciesByChain:{[k.MAINNET]:[{value:"ETH",display:"ETH"},{value:"BAT",display:"BAT"},{value:"USDT",display:"USDT"},{value:"DAI",display:"DAI"}],[k.BSC_MAINNET]:[{value:"BNB",display:"BNB"},{value:"BUSD",display:"BUSD"},{value:"1INCH",display:"1INCH"}]},includeFees:!0,api:!0,enforceMax:!1},[U.TRANSAK]:{line1:"Apple & Google Pay / Credit/Debit Card<br/>Bangkok Bank Mobile & iPay<br/>Bank Transfer (sepa/gbp) / SCB Mobile & Easy",line2:"0.99% - 5.5% or 5 USD",line3:"$5,000/day, $28,000/mo",supportPage:"https://support.transak.com/hc/en-US",minOrderValue:30,maxOrderValue:500,validCurrencies:ee(U.TRANSAK),validCryptoCurrenciesByChain:{[k.MAINNET]:[{value:"AAVE",display:"AAVE"},{value:"DAI",display:"DAI"},{value:"ETH",display:"ETH"},{value:"USDC",display:"USDC"},{value:"USDT",display:"USDT"}],[k.MATIC]:[{value:"AAVE",display:"AAVE"},{value:"DAI",display:"DAI"},{value:"MATIC",display:"MATIC"},{value:"USDC",display:"USDC"},{value:"USDT",display:"USDT"},{value:"WETH",display:"WETH"}],[k.BSC_MAINNET]:[{value:"BNB",display:"BNB"},{value:"BUSD",display:"BUSD"}],[k.AVALANCHE_MAINNET]:[{value:"AVAX",display:"AVAX"}]},includeFees:!0,enforceMax:!0},[U.BANXA]:{line1:"Debit Card/ <br>Apple Pay/ Bank transfer",line2:"0.49% - 2.9%",line3:"5,000€/purchase, 20,000€/mo",supportPage:"https://support.banxa.com",minOrderValue:20,maxOrderValue:15e3,validCurrencies:ee(U.BANXA),validCryptoCurrenciesByChain:{[k.MAINNET]:[{value:"ETH",display:"ETH"},{value:"USDT",display:"USDT"},{value:"BUSD",display:"BUSD"},{value:"LINK",display:"LINK"},{value:"USDC",display:"USDC"},{value:"CHZ",display:"CHZ"},{value:"BAT",display:"BAT"},{value:"MANA",display:"MANA"},{value:"AAVE",display:"AAVE"},{value:"COMP",display:"COMP"},{value:"ENJ",display:"ENJ"}],[k.MATIC]:[{value:"MATIC",display:"MATIC"}]},includeFees:!0,enforceMax:!0}},Jr={en:{embed:{continue:"Continue",actionRequired:"Authorization required",pendingAction:"Click continue to proceed with your request in a popup",cookiesRequired:"Cookies Required",enableCookies:"Please enable cookies in your browser preferences to access Torus",clickHere:"More Info"}},de:{embed:{continue:"Fortsetzen",actionRequired:"Autorisierung erforderlich",pendingAction:"Klicken Sie in einem Popup auf Weiter, um mit Ihrer Anfrage fortzufahren",cookiesRequired:"Cookies benötigt",enableCookies:"Bitte aktivieren Sie Cookies in Ihren Browsereinstellungen, um auf Torus zuzugreifen",clickHere:"Mehr Info"}},ja:{embed:{continue:"継続する",actionRequired:"認証が必要です",pendingAction:"続行をクリックして、ポップアップでリクエストを続行します",cookiesRequired:"必要なクッキー",enableCookies:"Torusにアクセスするには、ブラウザの設定でCookieを有効にしてください。",clickHere:"詳しくは"}},ko:{embed:{continue:"계속하다",actionRequired:"승인 필요",pendingAction:"팝업에서 요청을 진행하려면 계속을 클릭하십시오.",cookiesRequired:"쿠키 필요",enableCookies:"브라우저 환경 설정에서 쿠키를 활성화하여 Torus에 액세스하십시오.",clickHere:"더 많은 정보"}},zh:{embed:{continue:"继续",actionRequired:"需要授权",pendingAction:"单击继续以在弹出窗口中继续您的请求",cookiesRequired:"必填Cookie",enableCookies:"请在您的浏览器首选项中启用cookie以访问Torus。",clickHere:"更多信息"}}};var G={supportedVerifierList:Object.values(te),paymentProviders:Zr,api:"https://api.tor.us",translations:Jr,prodTorusUrl:"",localStorageKeyPrefix:"torus-"};const kt=o=>new Promise((e,t)=>{window.document.body!=null?Promise.resolve(o()).then(e).catch(t):window.document.addEventListener("DOMContentLoaded",()=>{Promise.resolve(o()).then(e).catch(t)})}),we=o=>{const e=window.document.createElement("template"),t=o.trim();return e.innerHTML=t,e.content.firstChild},Qr=function(o,e,t){for(var r=arguments.length,s=new Array(r>3?r-3:0),a=3;a<r;a++)s[a-3]=arguments[a];const l=()=>{t(...s),o.removeEventListener(e,l)};o.addEventListener(e,l)},F=(o,e,t)=>{const r=s=>{t(s),o.removeListener(e,r)};o.on(e,r)};async function ei(){return new Promise(o=>{document.readyState!=="loading"?o():Qr(document,"DOMContentLoaded",o)})}var N=ur.getLogger("torus-embed"),H={errors:{disconnected:()=>"Torus: Lost connection to Torus.",permanentlyDisconnected:()=>"Torus: Disconnected from iframe. Page reload required.",sendSiteMetadata:()=>"Torus: Failed to send site metadata. This is an internal error, please report this bug.",unsupportedSync:o=>`Torus: The Torus Ethereum provider does not support synchronous methods like ${o} without a callback parameter.`,invalidDuplexStream:()=>"Must provide a Node.js-style duplex stream.",invalidOptions:(o,e)=>`Invalid options. Received: { maxEventListeners: ${o}, shouldSendMetadata: ${e} }`,invalidRequestArgs:()=>"Expected a single, non-array, object argument.",invalidRequestMethod:()=>"'args.method' must be a non-empty string.",invalidRequestParams:()=>"'args.params' must be an object or array if provided.",invalidLoggerObject:()=>"'args.logger' must be an object if provided.",invalidLoggerMethod:o=>`'args.logger' must include required method '${o}'.`},info:{connected:o=>`Torus: Connected to chain with ID "${o}".`},warnings:{enableDeprecation:'Torus: ""ethereum.enable()" is deprecated and may be removed in the future. Please use "ethereum.send("eth_requestAccounts")" instead. For more information, see: https://eips.ethereum.org/EIPS/eip-1102',sendDeprecation:`Torus: "ethereum.send(...)" is deprecated and may be removed in the future. Please use "ethereum.sendAsync(...)" or "ethereum.request(...)" instead.
For more information, see: https://eips.ethereum.org/EIPS/eip-1193`,events:{close:`Torus: The event "close" is deprecated and may be removed in the future. Please use "disconnect" instead.
For more information, see: https://eips.ethereum.org/EIPS/eip-1193`,data:`Torus: The event "data" is deprecated and will be removed in the future.Use "message" instead.
For more information, see: https://eips.ethereum.org/EIPS/eip-1193#message`,networkChanged:`Torus: The event "networkChanged" is deprecated and may be removed in the future. Please use "chainChanged" instead.
For more information, see: https://eips.ethereum.org/EIPS/eip-1193`,notification:`Torus: The event "notification" is deprecated and may be removed in the future. Please use "message" instead.
For more information, see: https://eips.ethereum.org/EIPS/eip-1193`},publicConfigStore:'Torus: The property "publicConfigStore" is deprecated and WILL be removed in the future.'}};const{paymentProviders:Bt}=G,ti=(o,e)=>{const t={};if(!o)return{errors:t,isValid:!0};if(o&&!Bt[o])return t.provider="Invalid Provider",{errors:t,isValid:Object.keys(t).length===0};const r=Bt[o],s=e||{};if(s.fiatValue){const a=+parseFloat(s.fiatValue.toString())||0;a<r.minOrderValue&&(t.fiatValue="Requested amount is lower than supported"),a>r.maxOrderValue&&r.enforceMax&&(t.fiatValue="Requested amount is higher than supported")}if(s.selectedCurrency&&!r.validCurrencies.includes(s.selectedCurrency)&&(t.selectedCurrency="Unsupported currency"),s.selectedCryptoCurrency){const a=Object.values(r.validCryptoCurrenciesByChain).flat().map(u=>u.value),l=o===U.MOONPAY?s.selectedCryptoCurrency.toLowerCase():s.selectedCryptoCurrency;a&&!a.includes(l)&&(t.selectedCryptoCurrency="Unsupported cryptoCurrency")}return{errors:t,isValid:Object.keys(t).length===0}};function ri(){return(o,e,t)=>{(typeof o.method!="string"||!o.method)&&(e.error=oe.ethErrors.rpc.invalidRequest({message:"The request 'method' must be a non-empty string.",data:o})),t(r=>{const{error:s}=e;return s&&N.error(`MetaMask - RPC Error: ${s.message}`,s),r()})}}function Wt(o,e,t){let r=`MetaMask: Lost connection to "${o}".`;e!=null&&e.stack&&(r+=`
${e.stack}`),N.warn(r),t&&t.listenerCount("error")>0&&t.emit("error",r)}const re=()=>Math.random().toString(36).slice(2),ir=async(o,e)=>{let t,r;const s="1.38.6";let a=e.version||s;try{if((o==="binance"||o==="production")&&!e.version){let l;G.prodTorusUrl?l={data:G.prodTorusUrl}:l=await Zt(`${G.api}/latestversion?name=@toruslabs/torus-embed&version=${s}`,{},{useAPIKey:!0}),a=l.data,G.prodTorusUrl=l.data}}catch(l){N.error(l,"unable to fetch latest version")}switch(N.info("version used: ",a),o){case"binance":t=`https://binance.tor.us/v${a}`,r="info";break;case"testing":t="https://testing.tor.us",r="debug";break;case"bnb":t="https://bnb.tor.us",r="error";break;case"polygon":t="https://polygon.tor.us",r="error";break;case"lrc":t="https://lrc.tor.us",r="debug";break;case"beta":t="https://beta.tor.us",r="debug";break;case"development":t="http://localhost:4050",r="debug";break;default:t=`https://app.tor.us/v${a}`,r="error";break}return{torusUrl:t,logLevel:r}},qt=()=>{let o=window.navigator.language||"en-US";const e=o.split("-");return o=Object.prototype.hasOwnProperty.call(G.translations,e[0])?e[0]:"en",o},ii=["eth_subscription"],nr=()=>{},Ht="directories=0,titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=660,width=375",ni="directories=0,titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=740,width=1315",jt="directories=0,titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=700,width=450";function si(){const o=window.screenLeft!==void 0?window.screenLeft:window.screenX,e=window.screenTop!==void 0?window.screenTop:window.screenY,t=1200,r=700,s=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:window.screen.width,a=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:window.screen.height,l=1,u=Math.abs((s-t)/2/l+o),h=Math.abs((a-r)/2/l+e);return`titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=${r/l},width=${t/l},top=${h},left=${u}`}function Vt(o,e){var t=Object.keys(o);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(o);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(o,s).enumerable})),t.push.apply(t,r)}return t}function ai(o){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Vt(Object(t),!0).forEach(function(r){S(o,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(t)):Vt(Object(t)).forEach(function(r){Object.defineProperty(o,r,Object.getOwnPropertyDescriptor(t,r))})}return o}zt.defaultMaxListeners=100;const Kt=function(o,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return(r,s)=>r||s.error?e(r||s.error):!t||Array.isArray(s)?o(s):o(s.result)};class Le extends zt{constructor(e){let{maxEventListeners:t=100,shouldSendMetadata:r=!0,jsonRpcStreamName:s="provider"}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(super(),S(this,"chainId",void 0),S(this,"selectedAddress",void 0),S(this,"_rpcEngine",void 0),S(this,"networkVersion",void 0),S(this,"shouldSendMetadata",void 0),S(this,"isTorus",void 0),S(this,"_publicConfigStore",void 0),S(this,"tryPreopenHandle",void 0),S(this,"enable",void 0),S(this,"_state",void 0),S(this,"_jsonRpcConnection",void 0),S(this,"_sentWarnings",{enable:!1,experimentalMethods:!1,send:!1,publicConfigStore:!1,events:{close:!1,data:!1,networkChanged:!1,notification:!1}}),!Tr.duplex(e))throw new Error(H.errors.invalidDuplexStream());this.isTorus=!0,this.setMaxListeners(t),this._state=ai({},Le._defaultState),this.selectedAddress=null,this.networkVersion=null,this.chainId=null,this.shouldSendMetadata=r,this._handleAccountsChanged=this._handleAccountsChanged.bind(this),this._handleChainChanged=this._handleChainChanged.bind(this),this._handleUnlockStateChanged=this._handleUnlockStateChanged.bind(this),this._handleConnect=this._handleConnect.bind(this),this._handleDisconnect=this._handleDisconnect.bind(this),this._handleStreamDisconnect=this._handleStreamDisconnect.bind(this),this._sendSync=this._sendSync.bind(this),this._rpcRequest=this._rpcRequest.bind(this),this._warnOfDeprecation=this._warnOfDeprecation.bind(this),this._initializeState=this._initializeState.bind(this),this.request=this.request.bind(this),this.send=this.send.bind(this),this.sendAsync=this.sendAsync.bind(this);const a=new dr;je(e,a,e,this._handleStreamDisconnect.bind(this,"MetaMask")),this._publicConfigStore=new xt.ObservableStore({storageKey:"Metamask-Config"}),je(a.createStream("publicConfig"),xt.storeAsStream(this._publicConfigStore),Wt.bind(this,"MetaMask PublicConfigStore")),a.ignoreStream("phishing"),this.on("connect",()=>{this._state.isConnected=!0});const l=cr();je(l.stream,a.createStream(s),l.stream,this._handleStreamDisconnect.bind(this,"MetaMask RpcProvider"));const u=new hr;u.push(fr()),u.push(ri()),u.push(l.middleware),this._rpcEngine=u,l.events.on("notification",h=>{const{method:g,params:w}=h;g==="wallet_accountsChanged"?this._handleAccountsChanged(w):g==="wallet_unlockStateChanged"?this._handleUnlockStateChanged(w):g==="wallet_chainChanged"?this._handleChainChanged(w):ii.includes(h.method)&&(this.emit("data",h),this.emit("notification",w.result),this.emit("message",{type:g,data:w}))})}get publicConfigStore(){return this._sentWarnings.publicConfigStore||(N.warn(H.warnings.publicConfigStore),this._sentWarnings.publicConfigStore=!0),this._publicConfigStore}isConnected(){return this._state.isConnected}async request(e){if(!e||typeof e!="object"||Array.isArray(e))throw oe.ethErrors.rpc.invalidRequest({message:H.errors.invalidRequestArgs(),data:e});const{method:t,params:r}=e;if(typeof t!="string"||t.length===0)throw oe.ethErrors.rpc.invalidRequest({message:H.errors.invalidRequestMethod(),data:e});if(r!==void 0&&!Array.isArray(r)&&(typeof r!="object"||r===null))throw oe.ethErrors.rpc.invalidRequest({message:H.errors.invalidRequestParams(),data:e});return new Promise((s,a)=>{this._rpcRequest({method:t,params:r},Kt(s,a))})}sendAsync(e,t){this._rpcRequest(e,t)}addListener(e,t){return this._warnOfDeprecation(e),super.addListener(e,t)}on(e,t){return this._warnOfDeprecation(e),super.on(e,t)}once(e,t){return this._warnOfDeprecation(e),super.once(e,t)}prependListener(e,t){return this._warnOfDeprecation(e),super.prependListener(e,t)}prependOnceListener(e,t){return this._warnOfDeprecation(e),super.prependOnceListener(e,t)}async _initializeState(){try{const{accounts:e,chainId:t,isUnlocked:r,networkVersion:s}=await this.request({method:"wallet_getProviderState"});this.emit("connect",{chainId:t}),this._handleChainChanged({chainId:t,networkVersion:s}),this._handleUnlockStateChanged({accounts:e,isUnlocked:r}),this._handleAccountsChanged(e)}catch(e){N.error("MetaMask: Failed to get initial state. Please report this bug.",e)}finally{N.info("initialized state"),this._state.initialized=!0,this.emit("_initialized")}}_rpcRequest(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=t;const a=e;if(!Array.isArray(a)){if(a.jsonrpc||(a.jsonrpc="2.0"),a.method==="eth_accounts"||a.method==="eth_requestAccounts")s=(l,u)=>{this._handleAccountsChanged(u.result||[],a.method==="eth_accounts",r),t(l,u)};else if(a.method==="wallet_getProviderState"){this._rpcEngine.handle(e,s);return}}this.tryPreopenHandle(a,s)}send(e,t){return this._sentWarnings.send||(N.warn(H.warnings.sendDeprecation),this._sentWarnings.send=!0),typeof e=="string"&&(!t||Array.isArray(t))?new Promise((r,s)=>{try{this._rpcRequest({method:e,params:t},Kt(r,s,!1))}catch(a){s(a)}}):e&&typeof e=="object"&&typeof t=="function"?this._rpcRequest(e,t):this._sendSync(e)}_sendSync(e){let t;switch(e.method){case"eth_accounts":t=this.selectedAddress?[this.selectedAddress]:[];break;case"eth_coinbase":t=this.selectedAddress||null;break;case"eth_uninstallFilter":this._rpcRequest(e,nr),t=!0;break;case"net_version":t=this.networkVersion||null;break;default:throw new Error(H.errors.unsupportedSync(e.method))}return{id:e.id,jsonrpc:e.jsonrpc,result:t}}_handleConnect(e){this._state.isConnected||(this._state.isConnected=!0,this.emit("connect",{chainId:e}),N.debug(H.info.connected(e)))}_handleDisconnect(e,t){if(this._state.isConnected||!this._state.isPermanentlyDisconnected&&!e){this._state.isConnected=!1;let r;e?(r=new oe.EthereumRpcError(1013,t||H.errors.disconnected()),N.debug(r)):(r=new oe.EthereumRpcError(1011,t||H.errors.permanentlyDisconnected()),N.error(r),this.chainId=null,this._state.accounts=null,this.selectedAddress=null,this._state.isUnlocked=!1,this._state.isPermanentlyDisconnected=!0),this.emit("disconnect",r)}}_handleStreamDisconnect(e,t){Wt(e,t,this),this._handleDisconnect(!1,t?t.message:void 0)}_handleAccountsChanged(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=e;Array.isArray(s)||(N.error("MetaMask: Received non-array accounts parameter. Please report this bug.",s),s=[]);for(const a of e)if(typeof a!="string"){N.error("MetaMask: Received non-string account. Please report this bug.",e),s=[];break}Ar(this._state.accounts,s)||(t&&Array.isArray(this._state.accounts)&&this._state.accounts.length>0&&!r&&N.error('MetaMask: "eth_accounts" unexpectedly updated accounts. Please report this bug.',s),this._state.accounts=s,this.emit("accountsChanged",s)),this.selectedAddress!==s[0]&&(this.selectedAddress=s[0]||null)}_handleChainChanged(){let{chainId:e,networkVersion:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!e||!t){N.error("MetaMask: Received invalid network parameters. Please report this bug.",{chainId:e,networkVersion:t});return}t==="loading"?this._handleDisconnect(!0):(this._handleConnect(e),e!==this.chainId&&(this.chainId=e,this._state.initialized&&this.emit("chainChanged",this.chainId)))}_handleUnlockStateChanged(){let{accounts:e,isUnlocked:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(typeof t!="boolean"){N.error("MetaMask: Received invalid isUnlocked parameter. Please report this bug.",{isUnlocked:t});return}t!==this._state.isUnlocked&&(this._state.isUnlocked=t,this._handleAccountsChanged(e||[]))}_warnOfDeprecation(e){this._sentWarnings.events[e]===!1&&(N.warn(H.warnings.events[e]),this._sentWarnings.events[e]=!0)}}S(Le,"_defaultState",{accounts:null,isConnected:!1,isUnlocked:!1,initialized:!1,isPermanentlyDisconnected:!1,hasEmittedConnection:!1});const oi=o=>({algorithms:o.algorithms||["sha256"],delimiter:o.delimiter||" ",full:o.full||!1}),li=(o,e)=>{const t={};return o.algorithms.forEach(r=>{t[r]=Gr(r).update(e,"utf8").digest("base64")}),t},ui=(o,e)=>{let t="";return t+=Object.keys(e.hashes).map(r=>`${r}-${e.hashes[r]}`).join(o.delimiter),t},di=(o,e)=>{const t=oi(o),r={hashes:li(t,e),integrity:void 0};return r.integrity=ui(t,r),t.full?r:r.integrity};class Ft extends mr.EventEmitter{constructor(e){let{url:t,target:r,features:s}=e;super(),S(this,"url",void 0),S(this,"target",void 0),S(this,"features",void 0),S(this,"window",void 0),S(this,"windowTimer",void 0),S(this,"iClosedWindow",void 0),this.url=t,this.target=r||"_blank",this.features=s||si(),this.window=void 0,this.windowTimer=void 0,this.iClosedWindow=!1,this._setupTimer()}_setupTimer(){this.windowTimer=Number(setInterval(()=>{this.window&&this.window.closed&&(clearInterval(this.windowTimer),this.iClosedWindow||this.emit("close"),this.iClosedWindow=!1,this.window=void 0),this.window===void 0&&clearInterval(this.windowTimer)},500))}open(){var e;return this.window=window.open(this.url.href,this.target,this.features),(e=this.window)!==null&&e!==void 0&&e.focus&&this.window.focus(),Promise.resolve()}close(){this.iClosedWindow=!0,this.window&&this.window.close()}redirect(e){e?window.location.replace(this.url.href):window.location.href=this.url.href}}function Gt(o){return new Promise((e,t)=>{try{const r=document.createElement("img");r.onload=()=>e(!0),r.onerror=()=>e(!1),r.src=o}catch(r){t(r)}})}const ci=o=>{const{document:e}=o,t=e.querySelector('head > meta[property="og:site_name"]');if(t)return t.content;const r=e.querySelector('head > meta[name="title"]');return r?r.content:e.title&&e.title.length>0?e.title:o.location.hostname};async function hi(o){const{document:e}=o;let t=e.querySelector('head > link[rel="shortcut icon"]');return t&&await Gt(t.href)||(t=Array.from(e.querySelectorAll('head > link[rel="icon"]')).find(r=>Boolean(r.href)),t&&await Gt(t.href))?t.href:null}const fi=async()=>({name:ci(window),icon:await hi(window)});async function pi(o){try{const e=await fi();o.handle({jsonrpc:"2.0",id:re(),method:"wallet_sendDomainMetadata",params:e},nr)}catch(e){N.error({message:H.errors.sendSiteMetadata(),originalError:e})}}const gi=["host","chainId","networkName"];function Yt(o,e){var t=Object.keys(o);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(o);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(o,s).enumerable})),t.push.apply(t,r)}return t}function mi(o){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Yt(Object(t),!0).forEach(function(r){S(o,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(t)):Yt(Object(t)).forEach(function(r){Object.defineProperty(o,r,Object.getOwnPropertyDescriptor(t,r))})}return o}const yi={[ye.GOOGLE]:!0,[ye.FACEBOOK]:!0,[ye.REDDIT]:!0,[ye.TWITCH]:!0,[ye.DISCORD]:!0},sr="sha384-rKDzAQGTjTTHTfXsCxsUa85RHvDNSPuZxXAKdVdBqxl8Oad3Fn3uvFruOKq1pLhx",wi="max-age=3600",bi=["eth_sendTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","personal_sign","eth_getEncryptionPublicKey","eth_decrypt"];(async function(){try{if(typeof document>"u")return;const e=document.createElement("link"),{torusUrl:t}=await ir("production",{check:!1,hash:sr,version:""});e.href=`${t}/popup`,e.crossOrigin="anonymous",e.type="text/html",e.rel="prefetch",e.relList&&e.relList.supports&&e.relList.supports("prefetch")&&document.head.appendChild(e)}catch(e){N.warn(e)}})();class vi{constructor(){let{buttonPosition:e=ae.BOTTOM_LEFT,buttonSize:t=56,modalZIndex:r=99999,apiKey:s="torus-default"}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};S(this,"buttonPosition",ae.BOTTOM_LEFT),S(this,"buttonSize",void 0),S(this,"torusUrl",void 0),S(this,"torusIframe",void 0),S(this,"styleLink",void 0),S(this,"isLoggedIn",void 0),S(this,"isInitialized",void 0),S(this,"torusWidgetVisibility",void 0),S(this,"torusAlert",void 0),S(this,"apiKey",void 0),S(this,"modalZIndex",void 0),S(this,"alertZIndex",void 0),S(this,"torusAlertContainer",void 0),S(this,"isIframeFullScreen",void 0),S(this,"whiteLabel",void 0),S(this,"requestedVerifier",void 0),S(this,"currentVerifier",void 0),S(this,"embedTranslations",void 0),S(this,"ethereum",void 0),S(this,"provider",void 0),S(this,"communicationMux",void 0),S(this,"isLoginCallback",void 0),S(this,"paymentProviders",G.paymentProviders),S(this,"loginHint",""),S(this,"useWalletConnect",void 0),S(this,"isCustomLogin",!1),this.buttonPosition=e,this.buttonSize=t,this.torusUrl="",this.isLoggedIn=!1,this.isInitialized=!1,this.torusWidgetVisibility=!0,this.requestedVerifier="",this.currentVerifier="",this.apiKey=s,yr(s),this.modalZIndex=r,this.alertZIndex=r+1e3,this.isIframeFullScreen=!1}async init(){let{buildEnv:e=Yr.PRODUCTION,enableLogging:t=!1,enabledVerifiers:r=yi,network:s={host:"mainnet",chainId:null,networkName:"",blockExplorer:"",ticker:"",tickerName:""},loginConfig:a={},showTorusButton:l=!0,integrity:u={check:!1,hash:sr,version:""},whiteLabel:h,skipTKey:g=!1,useWalletConnect:w=!1,mfaLevel:m="default"}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.isInitialized)throw new Error("Already initialized");const{torusUrl:T,logLevel:M}=await ir(e,u);N.info(T,"url loaded"),this.torusUrl=T,this.whiteLabel=h,this.useWalletConnect=w,this.isCustomLogin=!!(a&&Object.keys(a).length>0)||!!(h&&Object.keys(h).length>0),N.setDefaultLevel(M),t?N.enableAll():N.disableAll(),this.torusWidgetVisibility=l;const D=new URL(T);D.pathname.endsWith("/")?D.pathname+="popup":D.pathname+="/popup",D.hash=`#isCustomLogin=${this.isCustomLogin}`,this.torusIframe=we(`<iframe
        id="torusIframe"
        allow=${w?"camera":""}
        class="torusIframe"
        src="${D.href}"
        style="display: none; position: fixed; top: 0; right: 0; width: 100%; color-scheme: none;
        height: 100%; border: none; border-radius: 0; z-index: ${this.modalZIndex}"
      ></iframe>`),this.torusAlertContainer=we('<div id="torusAlertContainer"></div>'),this.torusAlertContainer.style.display="none",this.torusAlertContainer.style.setProperty("z-index",this.alertZIndex.toString());const v=window.document.createElement("link");v.setAttribute("rel","stylesheet"),v.setAttribute("type","text/css"),v.setAttribute("href",`${T}/css/widget.css`),this.styleLink=v;const{defaultLanguage:W=qt(),customTranslations:f={}}=this.whiteLabel||{},A=pr(G.translations,f)[W]||G.translations[qt()];this.embedTranslations=A.embed;const x=async()=>(await ei(),new Promise((L,Y)=>{this.torusIframe.onload=async()=>{this._setupWeb3();const $=this.communicationMux.getStream("init_stream");$.on("data",X=>{const{name:ie,data:ne,error:K}=X;ie==="init_complete"&&ne.success?(this.isInitialized=!0,this._displayIframe(this.isIframeFullScreen),L(void 0)):K&&Y(new Error(K))}),$.write({name:"init_stream",data:{enabledVerifiers:r,loginConfig:a,whiteLabel:this.whiteLabel,buttonPosition:this.buttonPosition,buttonSize:this.buttonSize,torusWidgetVisibility:this.torusWidgetVisibility,apiKey:this.apiKey,skipTKey:g,network:s,mfaLevel:m}})},window.document.head.appendChild(this.styleLink),window.document.body.appendChild(this.torusIframe),window.document.body.appendChild(this.torusAlertContainer)}));if(e==="production"&&u.check){const L=`${T}/popup`,Y=await fetch(L,{cache:"reload"});if(Y.headers.get("Cache-Control")!==wi)throw new Error(`Unexpected Cache-Control headers, got ${Y.headers.get("Cache-Control")}`);const $=await Y.text(),X=di({algorithms:["sha384"]},$);if(N.info(X,"integrity"),X===u.hash)await x();else throw this.clearInit(),new Error("Integrity check failed")}else await x()}login(){let{verifier:e="",login_hint:t=""}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.isInitialized)throw new Error("Call init() first");return this.requestedVerifier=e,this.loginHint=t,this.ethereum.enable()}logout(){return new Promise((e,t)=>{if(!this.isLoggedIn){t(new Error("User has not logged in yet"));return}this.communicationMux.getStream("logout").write({name:"logOut"});const s=this.communicationMux.getStream("status");F(s,"data",l=>{l.loggedIn?t(new Error("Some Error Occured")):(this.isLoggedIn=!1,this.currentVerifier="",this.requestedVerifier="",e())})})}async cleanUp(){this.isLoggedIn&&await this.logout(),this.clearInit()}clearInit(){function e(t){return t instanceof Element||t instanceof HTMLDocument}e(this.styleLink)&&window.document.body.contains(this.styleLink)&&(this.styleLink.remove(),this.styleLink=void 0),e(this.torusIframe)&&window.document.body.contains(this.torusIframe)&&(this.torusIframe.remove(),this.torusIframe=void 0),e(this.torusAlertContainer)&&window.document.body.contains(this.torusAlertContainer)&&(this.torusAlert=void 0,this.torusAlertContainer.remove(),this.torusAlertContainer=void 0),this.isInitialized=!1}hideTorusButton(){this.torusWidgetVisibility=!1,this._sendWidgetVisibilityStatus(!1),this._displayIframe()}showTorusButton(){this.torusWidgetVisibility=!0,this._sendWidgetVisibilityStatus(!0),this._displayIframe()}setProvider(e){let{host:t="mainnet",chainId:r=null,networkName:s=""}=e,a=Rr(e,gi);return new Promise((l,u)=>{const h=this.communicationMux.getStream("provider_change");F(h,"data",m=>{const{err:T,success:M}=m.data;N.info(m),T?u(T):M?l():u(new Error("some error occured"))});const w=re();this._handleWindow(w,{target:"_blank",features:Ht}),h.write({name:"show_provider_change",data:{network:mi({host:t,chainId:r,networkName:s},a),preopenInstanceId:w,override:!1}})})}showWallet(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=this.communicationMux.getStream("show_wallet"),s=e?`/${e}`:"";r.write({name:"show_wallet",data:{path:s}}),F(r,"data",l=>{if(l.name==="show_wallet_instance"){const{instanceId:u}=l.data,h=new URL(`${this.torusUrl}/wallet${s}`);h.searchParams.append("integrity","true"),h.searchParams.append("instanceId",u),Object.keys(t).forEach(w=>{h.searchParams.append(w,t[w])}),h.hash=`#isCustomLogin=${this.isCustomLogin}`,new Ft({url:h,features:ni}).open()}})}async getPublicAddress(e){let{verifier:t,verifierId:r,isExtended:s=!1}=e;if(!G.supportedVerifierList.includes(t)||!Ut[t])throw new Error("Unsupported verifier");const a=t,l=Ut[t],u=new URL("https://api.tor.us/lookup/torus");return u.searchParams.append("verifier",l),u.searchParams.append("verifierId",r),u.searchParams.append("walletVerifier",a),u.searchParams.append("network","mainnet"),u.searchParams.append("isExtended",s.toString()),Zt(u.href,{headers:{"Content-Type":"application/json; charset=utf-8"}},{useAPIKey:!0})}getUserInfo(e){return new Promise((t,r)=>{if(this.isLoggedIn){const s=this.communicationMux.getStream("user_info_access");s.write({name:"user_info_access_request"}),F(s,"data",l=>{const{name:u,data:{approved:h,payload:g,rejected:w,newRequest:m}}=l;if(u==="user_info_access_response"){if(h)t(g);else if(w)r(new Error("User rejected the request"));else if(m){const T=this.communicationMux.getStream("user_info");F(T,"data",v=>{v.name==="user_info_response"&&(v.data.approved?t(v.data.payload):r(new Error("User rejected the request")))});const D=re();this._handleWindow(D,{target:"_blank",features:Ht}),T.write({name:"user_info_request",data:{message:e,preopenInstanceId:D}})}}})}else r(new Error("User has not logged in yet"))})}initiateTopup(e,t){return new Promise((r,s)=>{if(this.isInitialized){const{errors:a,isValid:l}=ti(e,t);if(!l){s(new Error(JSON.stringify(a)));return}const u=this.communicationMux.getStream("topup");F(u,"data",w=>{w.name==="topup_response"&&(w.data.success?r(w.data.success):s(new Error(w.data.error)))});const g=re();this._handleWindow(g),u.write({name:"topup_request",data:{provider:e,params:t,preopenInstanceId:g}})}else s(new Error("Torus is not initialized yet"))})}async loginWithPrivateKey(e){const{privateKey:t,userInfo:r}=e;return new Promise((s,a)=>{if(this.isInitialized){if(Buffer.from(t,"hex").length!==32){a(new Error("Invalid private key, Please provide a 32 byte valid secp25k1 private key"));return}const l=this.communicationMux.getStream("login_with_private_key");F(l,"data",h=>{h.name==="login_with_private_key_response"&&(h.data.success?s(h.data.success):a(new Error(h.data.error)))}),l.write({name:"login_with_private_key_request",data:{privateKey:t,userInfo:r}})}else a(new Error("Torus is not initialized yet"))})}async showWalletConnectScanner(){if(!this.useWalletConnect)throw new Error("Set `useWalletConnect` as true in init function options to use wallet connect scanner");return new Promise((e,t)=>{if(this.isLoggedIn){const r=this.communicationMux.getStream("wallet_connect_stream");F(r,"data",a=>{a.name==="wallet_connect_stream_res"&&(a.data.success?e(a.data.success):t(new Error(a.data.error)),this._displayIframe())}),r.write({name:"wallet_connect_stream_req"}),this._displayIframe(!0)}else t(new Error("User has not logged in yet"))})}_handleWindow(e){let{url:t,target:r,features:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e){const a=this.communicationMux.getStream("window"),l=new URL(t||`${this.torusUrl}/redirect?preopenInstanceId=${e}`);l.hash?l.hash+=`&isCustomLogin=${this.isCustomLogin}`:l.hash=`#isCustomLogin=${this.isCustomLogin}`;const u=new Ft({url:l,target:r,features:s});if(u.open(),!u.window){this._createPopupBlockAlert(e,l.href);return}a.write({name:"opened_window",data:{preopenInstanceId:e}});const h=g=>{let{preopenInstanceId:w,close:m}=g;w===e&&m&&(u.close(),a.removeListener("data",h))};a.on("data",h),u.once("close",()=>{a.write({data:{preopenInstanceId:e,closed:!0}}),a.removeListener("data",h)})}}_setEmbedWhiteLabel(e){const{theme:t}=this.whiteLabel||{};if(t){const{isDark:r=!1,colors:s={}}=t;r&&e.classList.add("torus-dark"),s.torusBrand1&&e.style.setProperty("--torus-brand-1",s.torusBrand1),s.torusGray2&&e.style.setProperty("--torus-gray-2",s.torusGray2)}}_getLogoUrl(){var e,t;let r=`${this.torusUrl}/images/torus_icon-blue.svg`;if((e=this.whiteLabel)!==null&&e!==void 0&&(t=e.theme)!==null&&t!==void 0&&t.isDark){var s;r=((s=this.whiteLabel)===null||s===void 0?void 0:s.logoLight)||r}else{var a;r=((a=this.whiteLabel)===null||a===void 0?void 0:a.logoDark)||r}return r}_sendWidgetVisibilityStatus(e){this.communicationMux.getStream("torus-widget-visibility").write({data:e})}_displayIframe(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t={},r=this.buttonSize+14;if(e)t.display="block",t.width="100%",t.height="100%",t.top="0px",t.right="0px",t.left="0px",t.bottom="0px";else switch(t.display=this.torusWidgetVisibility?"block":"none",t.height=`${r}px`,t.width=`${r}px`,this.buttonPosition){case ae.TOP_LEFT:t.top="0px",t.left="0px",t.right="auto",t.bottom="auto";break;case ae.TOP_RIGHT:t.top="0px",t.right="0px",t.left="auto",t.bottom="auto";break;case ae.BOTTOM_RIGHT:t.bottom="0px",t.right="0px",t.top="auto",t.left="auto";break;case ae.BOTTOM_LEFT:default:t.bottom="0px",t.left="0px",t.top="auto",t.right="auto";break}Object.assign(this.torusIframe.style,t),this.isIframeFullScreen=e}_setupWeb3(){N.info("setupWeb3 running");const e=new ot({name:"embed_metamask",target:"iframe_metamask",targetWindow:this.torusIframe.contentWindow,targetOrigin:new URL(this.torusUrl).origin}),t=new ot({name:"embed_comm",target:"iframe_comm",targetWindow:this.torusIframe.contentWindow,targetOrigin:new URL(this.torusUrl).origin}),r=new Le(e),s=w=>{const m=r[w];r[w]=function(M){if(M&&M==="eth_requestAccounts")return r.enable();for(var D=arguments.length,v=new Array(D>1?D-1:0),W=1;W<D;W++)v[W-1]=arguments[W];return m.apply(this,[M,...v])}};s("send"),s("sendAsync"),r.enable=()=>new Promise((w,m)=>{r.sendAsync({jsonrpc:"2.0",id:re(),method:"eth_requestAccounts",params:[]},(T,M)=>{const{result:D}=M||{};if(T)setTimeout(()=>{m(T)},50);else if(Array.isArray(D)&&D.length>0){const v=()=>{if(this.requestedVerifier!==""&&this.currentVerifier!==this.requestedVerifier){const{requestedVerifier:W}=this;this.logout().then(f=>{this.requestedVerifier=W,this._showLoginPopup(!0,w,m)}).catch(f=>m(f))}else w(D)};this.isLoggedIn?v():this.isLoginCallback=v}else this._showLoginPopup(!0,w,m)})}),r.tryPreopenHandle=(w,m)=>{const T=w;if(!Array.isArray(T)&&bi.includes(T.method)){const M=re();this._handleWindow(M,{target:"_blank",features:jt}),T.preopenInstanceId=M}r._rpcEngine.handle(T,m)};const a=new Proxy(r,{deleteProperty:()=>!0});this.ethereum=a;const l=gr(t);this.communicationMux=l,l.getStream("window").on("data",w=>{w.name==="create_window"&&this._createPopupBlockAlert(w.data.preopenInstanceId,w.data.url)}),l.getStream("widget").on("data",w=>{const{data:m}=w;this._displayIframe(m)}),l.getStream("status").on("data",w=>{w.loggedIn?(this.isLoggedIn=w.loggedIn,this.currentVerifier=w.verifier):this._displayIframe(),this.isLoginCallback&&(this.isLoginCallback(),delete this.isLoginCallback)}),this.provider=a,this.provider.shouldSendMetadata&&pi(this.provider._rpcEngine),r._initializeState(),N.debug("Torus - injected provider")}_showLoginPopup(e,t,r){const s=l=>{const{err:u,selectedAddress:h}=l;u?(N.error(u),r&&r(u)):t&&t([h]),this.isIframeFullScreen&&this._displayIframe()},a=this.communicationMux.getStream("oauth");if(!this.requestedVerifier)this._displayIframe(!0),F(a,"data",s),a.write({name:"oauth_modal",data:{calledFromEmbed:e}});else{F(a,"data",s);const l=re();this._handleWindow(l),a.write({name:"oauth",data:{calledFromEmbed:e,verifier:this.requestedVerifier,preopenInstanceId:l,login_hint:this.loginHint}})}}_createPopupBlockAlert(e,t){const r=this._getLogoUrl(),s=we(`<div id="torusAlert" class="torus-alert--v2"><div id="torusAlert__logo"><img src="${r}" /></div><div><h1 id="torusAlert__title">${this.embedTranslations.actionRequired}</h1><p id="torusAlert__desc">${this.embedTranslations.pendingAction}</p></div></div>`),a=we(`<div><a id="torusAlert__btn">${this.embedTranslations.continue}</a></div>`),l=we('<div id="torusAlert__btn-container"></div>');l.appendChild(a),s.appendChild(l);const u=()=>{a.addEventListener("click",()=>{this._handleWindow(e,{url:t,target:"_blank",features:jt}),s.remove(),this.torusAlertContainer.children.length===0&&(this.torusAlertContainer.style.display="none")})};this._setEmbedWhiteLabel(s),kt(()=>{this.torusAlertContainer.style.display="block",this.torusAlertContainer.appendChild(s)}),kt(u)}}function $t(o,e){var t=Object.keys(o);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(o);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(o,s).enumerable})),t.push.apply(t,r)}return t}function tt(o){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?$t(Object(t),!0).forEach(function(r){S(o,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(t)):$t(Object(t)).forEach(function(r){Object.defineProperty(o,r,Object.getOwnPropertyDescriptor(t,r))})}return o}class Oi extends Dr{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),S(this,"name",Ae.TORUS_EVM),S(this,"adapterNamespace",wr.EIP155),S(this,"currentChainNamespace",lt.EIP155),S(this,"type",br.EXTERNAL),S(this,"status",q.NOT_READY),S(this,"torusInstance",null),S(this,"torusWalletOptions",void 0),S(this,"initParams",void 0),S(this,"loginSettings",{}),S(this,"rehydrated",!1),this.torusWalletOptions=e.adapterSettings||{},this.initParams=e.initParams||{},this.loginSettings=e.loginSettings||{},this.chainConfig=e.chainConfig||null,this.sessionTime=e.sessionTime||86400}get provider(){return this.status===q.CONNECTED&&this.torusInstance?this.torusInstance.provider:null}set provider(e){throw new Error("Not implemented")}async init(e){super.checkInitializationRequirements();let t;if(this.chainConfig){const{chainId:r,blockExplorer:s,displayName:a,rpcTarget:l,ticker:u,tickerName:h}=this.chainConfig;t={chainId:Number.parseInt(r,16),host:l,blockExplorer:s,networkName:a,ticker:u,tickerName:h}}else{this.chainConfig=vr(lt.EIP155,1);const{blockExplorer:r,displayName:s,chainId:a,ticker:l,tickerName:u}=this.chainConfig;t={chainId:Number.parseInt(a,16),host:"mainnet",blockExplorer:r,networkName:s,ticker:l,tickerName:u}}this.torusInstance=new vi(this.torusWalletOptions),Ve.debug("initializing torus evm adapter init"),await this.torusInstance.init(tt(tt({showTorusButton:!1},this.initParams),{},{network:t})),this.status=q.READY,this.emit(De.READY,Ae.TORUS_EVM);try{Ve.debug("initializing torus evm adapter"),e.autoConnect&&(this.rehydrated=!0,await this.connect())}catch(r){Ve.error("Failed to connect with torus evm provider",r),this.emit(De.ERRORED,r)}}async connect(){if(super.checkConnectionRequirements(),!this.torusInstance)throw Re.notReady("Torus wallet is not initialized");this.status=q.CONNECTING,this.emit(De.CONNECTING,{adapter:Ae.TORUS_EVM});try{await this.torusInstance.login(this.loginSettings);const{chainId:e}=this.torusInstance.provider;if(e&&parseInt(e)!==parseInt(this.chainConfig.chainId,16)){const{chainId:t,blockExplorer:r,displayName:s,rpcTarget:a,ticker:l,tickerName:u}=this.chainConfig,h={chainId:Number.parseInt(t,16),host:a,blockExplorer:r,networkName:s,tickerName:u,ticker:l};await this.torusInstance.setProvider(tt({},h));const g=await this.torusInstance.ethereum.request({method:"eth_chainId"});if(g&&parseInt(g)!==parseInt(this.chainConfig.chainId,16))throw Re.fromCode(5e3,"Not connected to correct chainId. Expected: ".concat(this.chainConfig.chainId,", Current: ").concat(g))}return this.status=q.CONNECTED,this.torusInstance.showTorusButton(),this.emit(q.CONNECTED,{adapter:Ae.TORUS_EVM,reconnected:this.rehydrated}),this.provider}catch(e){throw this.status=q.READY,this.rehydrated=!1,this.emit(q.ERRORED,e),e instanceof _r?e:ut.connectionError("Failed to login with torus wallet")}}async disconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{cleanup:!1};if(!this.torusInstance)throw Re.notReady("Torus wallet is not initialized");await super.disconnect(),await this.torusInstance.logout(),this.torusInstance.hideTorusButton(),e.cleanup?(this.status=q.NOT_READY,this.torusInstance=null):this.status=q.READY,this.rehydrated=!1,this.emit(De.DISCONNECTED)}async getUserInfo(){if(this.status!==q.CONNECTED)throw ut.notConnectedError("Not connected with wallet");if(!this.torusInstance)throw Re.notReady("Torus wallet is not initialized");return await this.torusInstance.getUserInfo("")}setAdapterSettings(e){this.status!==q.READY&&e!=null&&e.sessionTime&&(this.sessionTime=e.sessionTime)}}export{Oi as TorusWalletAdapter};
