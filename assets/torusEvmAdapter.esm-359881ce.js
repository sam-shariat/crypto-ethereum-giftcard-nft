import{r as Ze,d as Je,c as Z,e as It,T as ve,U as Yt,q as Xt,S as Pt,f as b,K as Mt,V as zt,D as Ke,B as Zt,J as Jt,F as Qt,X as ue,n as er,Y as it,x as tr,Z as rr,$ as ir,m as Ee,i as nr,C as nt,p as sr,A as H,h as ar,l as qe,k as Te,W as Ae,a0 as or,j as st}from"./base.esm-e36f3d2a.js";import{_ as lr}from"./objectWithoutPropertiesLoose-4f48578a.js";import{u as ur,b as dr}from"./browser-a359bae0.js";import{i as cr,f as hr}from"./index-c5dcf017.js";import{B as fr}from"./baseEvmAdapter.esm-4d4128f0.js";function pr(i,e){if(i==null)return{};var t=lr(i,e),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(i);for(a=0;a<o.length;a++)r=o[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(i,r)&&(t[r]=i[r])}return t}var ze={},Re={};Object.defineProperty(Re,"__esModule",{value:!0});Re.storeAsStream=void 0;const gr=Ze;class mr extends gr.Duplex{constructor(e){super({objectMode:!0}),this.resume(),this.handler=t=>this.push(t),this.obsStore=e,this.obsStore.subscribe(this.handler)}pipe(e,t){const r=super.pipe(e,t);return e.write(this.obsStore.getState()),r}_write(e,t,r){this.obsStore.putState(e),r()}_read(e){}_destroy(e,t){this.obsStore.unsubscribe(this.handler),super._destroy(e,t)}}function yr(i){return new mr(i)}Re.storeAsStream=yr;var Ie={},fe={},Qe={};Object.defineProperty(Qe,"__esModule",{value:!0});const wr=Je();function at(i,e,t){try{Reflect.apply(i,e,t)}catch(r){setTimeout(()=>{throw r})}}function br(i){const e=i.length,t=new Array(e);for(let r=0;r<e;r+=1)t[r]=i[r];return t}class vr extends wr.EventEmitter{emit(e,...t){let r=e==="error";const a=this._events;if(a!==void 0)r=r&&a.error===void 0;else if(!r)return!1;if(r){let d;if(t.length>0&&([d]=t),d instanceof Error)throw d;const h=new Error(`Unhandled error.${d?` (${d.message})`:""}`);throw h.context=d,h}const o=a[e];if(o===void 0)return!1;if(typeof o=="function")at(o,this,t);else{const d=o.length,h=br(o);for(let p=0;p<d;p+=1)at(h[p],this,t)}return!0}}Qe.default=vr;var _r=Z&&Z.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(fe,"__esModule",{value:!0});fe.ObservableStore=void 0;const Sr=_r(Qe);class Cr extends Sr.default{constructor(e){super(),e?this._state=e:this._state={}}getState(){return this._getState()}putState(e){this._putState(e),this.emit("update",e)}updateState(e){if(e&&typeof e=="object"){const t=this.getState();this.putState(Object.assign(Object.assign({},t),e))}else this.putState(e)}subscribe(e){this.on("update",e)}unsubscribe(e){this.removeListener("update",e)}_getState(){return this._state}_putState(e){this._state=e}}fe.ObservableStore=Cr;Object.defineProperty(Ie,"__esModule",{value:!0});Ie.ComposedStore=void 0;const Er=fe;class Tr extends Er.ObservableStore{constructor(e){super({}),this._children=e||{},Object.keys(this._children).forEach(t=>{const r=this._children[t];this._addChild(t,r)})}_addChild(e,t){const r=a=>{const o=this.getState();o[e]=a,this.putState(o)};t.subscribe(r),r(t.getState())}}Ie.ComposedStore=Tr;var Pe={};Object.defineProperty(Pe,"__esModule",{value:!0});Pe.MergedStore=void 0;const Ar=fe;class Dr extends Ar.ObservableStore{constructor(e=[]){super({}),this._children=e,e.forEach(t=>this._addChild(t)),this._updateWholeState()}_addChild(e){e.subscribe(()=>this._updateWholeState())}_updateWholeState(){const e=this._children.map(r=>r.getState()),t=Object.assign({},...e);this.putState(t)}}Pe.MergedStore=Dr;var Me={},we={},Or={get exports(){return we},set exports(i){we=i}},De={},Rr={get exports(){return De},set exports(i){De=i}},de={},ot={get exports(){return de},set exports(i){de=i}};typeof process>"u"||!process.version||process.version.indexOf("v0.")===0||process.version.indexOf("v1.")===0&&process.version.indexOf("v1.8.")!==0?ot.exports={nextTick:Ir}:ot.exports=process;function Ir(i,e,t,r){if(typeof i!="function")throw new TypeError('"callback" argument must be a function');var a=arguments.length,o,d;switch(a){case 0:case 1:return process.nextTick(i);case 2:return process.nextTick(function(){i.call(null,e)});case 3:return process.nextTick(function(){i.call(null,e,t)});case 4:return process.nextTick(function(){i.call(null,e,t,r)});default:for(o=new Array(a-1),d=0;d<o.length;)o[d++]=arguments[d];return process.nextTick(function(){i.apply(null,o)})}}var Pr={}.toString,Mr=Array.isArray||function(i){return Pr.call(i)=="[object Array]"},Nt=Je().EventEmitter,ne={},Nr={get exports(){return ne},set exports(i){ne=i}};(function(i,e){var t=It,r=t.Buffer;function a(d,h){for(var p in d)h[p]=d[p]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?i.exports=t:(a(t,e),e.Buffer=o);function o(d,h,p){return r(d,h,p)}a(r,o),o.from=function(d,h,p){if(typeof d=="number")throw new TypeError("Argument must not be a number");return r(d,h,p)},o.alloc=function(d,h,p){if(typeof d!="number")throw new TypeError("Argument must be a number");var C=r(d);return h!==void 0?typeof p=="string"?C.fill(h,p):C.fill(h):C.fill(0),C},o.allocUnsafe=function(d){if(typeof d!="number")throw new TypeError("Argument must be a number");return r(d)},o.allocUnsafeSlow=function(d){if(typeof d!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(d)}})(Nr,ne);var x={};function Lr(i){return Array.isArray?Array.isArray(i):Ne(i)==="[object Array]"}x.isArray=Lr;function kr(i){return typeof i=="boolean"}x.isBoolean=kr;function Ur(i){return i===null}x.isNull=Ur;function xr(i){return i==null}x.isNullOrUndefined=xr;function Br(i){return typeof i=="number"}x.isNumber=Br;function Wr(i){return typeof i=="string"}x.isString=Wr;function Hr(i){return typeof i=="symbol"}x.isSymbol=Hr;function jr(i){return i===void 0}x.isUndefined=jr;function Vr(i){return Ne(i)==="[object RegExp]"}x.isRegExp=Vr;function Kr(i){return typeof i=="object"&&i!==null}x.isObject=Kr;function qr(i){return Ne(i)==="[object Date]"}x.isDate=qr;function Fr(i){return Ne(i)==="[object Error]"||i instanceof Error}x.isError=Fr;function Gr(i){return typeof i=="function"}x.isFunction=Gr;function $r(i){return i===null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||typeof i=="symbol"||typeof i>"u"}x.isPrimitive=$r;x.isBuffer=It.Buffer.isBuffer;function Ne(i){return Object.prototype.toString.call(i)}var Oe={},Yr={get exports(){return Oe},set exports(i){Oe=i}},lt;function Xr(){return lt||(lt=1,function(i){function e(o,d){if(!(o instanceof d))throw new TypeError("Cannot call a class as a function")}var t=ne.Buffer,r=Ze;function a(o,d,h){o.copy(d,h)}i.exports=function(){function o(){e(this,o),this.head=null,this.tail=null,this.length=0}return o.prototype.push=function(h){var p={data:h,next:null};this.length>0?this.tail.next=p:this.head=p,this.tail=p,++this.length},o.prototype.unshift=function(h){var p={data:h,next:this.head};this.length===0&&(this.tail=p),this.head=p,++this.length},o.prototype.shift=function(){if(this.length!==0){var h=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,h}},o.prototype.clear=function(){this.head=this.tail=null,this.length=0},o.prototype.join=function(h){if(this.length===0)return"";for(var p=this.head,C=""+p.data;p=p.next;)C+=h+p.data;return C},o.prototype.concat=function(h){if(this.length===0)return t.alloc(0);if(this.length===1)return this.head.data;for(var p=t.allocUnsafe(h>>>0),C=this.head,v=0;C;)a(C.data,p,v),v+=C.data.length,C=C.next;return p},o}(),r&&r.inspect&&r.inspect.custom&&(i.exports.prototype[r.inspect.custom]=function(){var o=r.inspect({length:this.length});return this.constructor.name+" "+o})}(Yr)),Oe}var ut=de;function zr(i,e){var t=this,r=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return r||a?(e?e(i):i&&(!this._writableState||!this._writableState.errorEmitted)&&ut.nextTick(dt,this,i),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(i||null,function(o){!e&&o?(ut.nextTick(dt,t,o),t._writableState&&(t._writableState.errorEmitted=!0)):e&&e(o)}),this)}function Zr(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function dt(i,e){i.emit("error",e)}var Lt={destroy:zr,undestroy:Zr},Fe,ct;function kt(){if(ct)return Fe;ct=1;var i=de;Fe=E;function e(l){var u=this;this.next=null,this.entry=null,this.finish=function(){xe(u,l)}}var t=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:i.nextTick,r;E.WritableState=N;var a=Object.create(x);a.inherits=ve;var o={deprecate:Yt},d=Nt,h=ne.Buffer,p=Z.Uint8Array||function(){};function C(l){return h.from(l)}function v(l){return h.isBuffer(l)||l instanceof p}var y=Lt;a.inherits(E,d);function O(){}function N(l,u){r=r||ce(),l=l||{};var g=u instanceof r;this.objectMode=!!l.objectMode,g&&(this.objectMode=this.objectMode||!!l.writableObjectMode);var _=l.highWaterMark,D=l.writableHighWaterMark,P=this.objectMode?16:16*1024;_||_===0?this.highWaterMark=_:g&&(D||D===0)?this.highWaterMark=D:this.highWaterMark=P,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var V=l.decodeStrings===!1;this.decodeStrings=!V,this.defaultEncoding=l.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(K){Y(u,K)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new e(this)}N.prototype.getBuffer=function(){for(var u=this.bufferedRequest,g=[];u;)g.push(u),u=u.next;return g},function(){try{Object.defineProperty(N.prototype,"buffer",{get:o.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var R;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(R=Function.prototype[Symbol.hasInstance],Object.defineProperty(E,Symbol.hasInstance,{value:function(l){return R.call(this,l)?!0:this!==E?!1:l&&l._writableState instanceof N}})):R=function(l){return l instanceof this};function E(l){if(r=r||ce(),!R.call(E,this)&&!(this instanceof r))return new E(l);this._writableState=new N(l,this),this.writable=!0,l&&(typeof l.write=="function"&&(this._write=l.write),typeof l.writev=="function"&&(this._writev=l.writev),typeof l.destroy=="function"&&(this._destroy=l.destroy),typeof l.final=="function"&&(this._final=l.final)),d.call(this)}E.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function W(l,u){var g=new Error("write after end");l.emit("error",g),i.nextTick(u,g)}function c(l,u,g,_){var D=!0,P=!1;return g===null?P=new TypeError("May not write null values to stream"):typeof g!="string"&&g!==void 0&&!u.objectMode&&(P=new TypeError("Invalid non-string/buffer chunk")),P&&(l.emit("error",P),i.nextTick(_,P),D=!1),D}E.prototype.write=function(l,u,g){var _=this._writableState,D=!1,P=!_.objectMode&&v(l);return P&&!h.isBuffer(l)&&(l=C(l)),typeof u=="function"&&(g=u,u=null),P?u="buffer":u||(u=_.defaultEncoding),typeof g!="function"&&(g=O),_.ended?W(this,g):(P||c(this,_,l,g))&&(_.pendingcb++,D=T(this,_,P,l,u,g)),D},E.prototype.cork=function(){var l=this._writableState;l.corked++},E.prototype.uncork=function(){var l=this._writableState;l.corked&&(l.corked--,!l.writing&&!l.corked&&!l.finished&&!l.bufferProcessing&&l.bufferedRequest&&ae(this,l))},E.prototype.setDefaultEncoding=function(u){if(typeof u=="string"&&(u=u.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((u+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+u);return this._writableState.defaultEncoding=u,this};function m(l,u,g){return!l.objectMode&&l.decodeStrings!==!1&&typeof u=="string"&&(u=h.from(u,g)),u}Object.defineProperty(E.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function T(l,u,g,_,D,P){if(!g){var V=m(u,_,D);_!==V&&(g=!0,D="buffer",_=V)}var K=u.objectMode?1:_.length;u.length+=K;var Q=u.length<u.highWaterMark;if(Q||(u.needDrain=!0),u.writing||u.corked){var ee=u.lastBufferedRequest;u.lastBufferedRequest={chunk:_,encoding:D,isBuf:g,callback:P,next:null},ee?ee.next=u.lastBufferedRequest:u.bufferedRequest=u.lastBufferedRequest,u.bufferedRequestCount+=1}else k(l,u,!1,K,_,D,P);return Q}function k(l,u,g,_,D,P,V){u.writelen=_,u.writecb=V,u.writing=!0,u.sync=!0,g?l._writev(D,u.onwrite):l._write(D,P,u.onwrite),u.sync=!1}function L(l,u,g,_,D){--u.pendingcb,g?(i.nextTick(D,_),i.nextTick(J,l,u),l._writableState.errorEmitted=!0,l.emit("error",_)):(D(_),l._writableState.errorEmitted=!0,l.emit("error",_),J(l,u))}function $(l){l.writing=!1,l.writecb=null,l.length-=l.writelen,l.writelen=0}function Y(l,u){var g=l._writableState,_=g.sync,D=g.writecb;if($(g),u)L(l,g,_,u,D);else{var P=q(g);!P&&!g.corked&&!g.bufferProcessing&&g.bufferedRequest&&ae(l,g),_?t(X,l,g,P,D):X(l,g,P,D)}}function X(l,u,g,_){g||se(l,u),u.pendingcb--,_(),J(l,u)}function se(l,u){u.length===0&&u.needDrain&&(u.needDrain=!1,l.emit("drain"))}function ae(l,u){u.bufferProcessing=!0;var g=u.bufferedRequest;if(l._writev&&g&&g.next){var _=u.bufferedRequestCount,D=new Array(_),P=u.corkedRequestsFree;P.entry=g;for(var V=0,K=!0;g;)D[V]=g,g.isBuf||(K=!1),g=g.next,V+=1;D.allBuffers=K,k(l,u,!0,u.length,D,"",P.finish),u.pendingcb++,u.lastBufferedRequest=null,P.next?(u.corkedRequestsFree=P.next,P.next=null):u.corkedRequestsFree=new e(u),u.bufferedRequestCount=0}else{for(;g;){var Q=g.chunk,ee=g.encoding,n=g.callback,s=u.objectMode?1:Q.length;if(k(l,u,!1,s,Q,ee,n),g=g.next,u.bufferedRequestCount--,u.writing)break}g===null&&(u.lastBufferedRequest=null)}u.bufferedRequest=g,u.bufferProcessing=!1}E.prototype._write=function(l,u,g){g(new Error("_write() is not implemented"))},E.prototype._writev=null,E.prototype.end=function(l,u,g){var _=this._writableState;typeof l=="function"?(g=l,l=null,u=null):typeof u=="function"&&(g=u,u=null),l!=null&&this.write(l,u),_.corked&&(_.corked=1,this.uncork()),!_.ending&&!_.finished&&Ue(this,_,g)};function q(l){return l.ending&&l.length===0&&l.bufferedRequest===null&&!l.finished&&!l.writing}function _e(l,u){l._final(function(g){u.pendingcb--,g&&l.emit("error",g),u.prefinished=!0,l.emit("prefinish"),J(l,u)})}function Se(l,u){!u.prefinished&&!u.finalCalled&&(typeof l._final=="function"?(u.pendingcb++,u.finalCalled=!0,i.nextTick(_e,l,u)):(u.prefinished=!0,l.emit("prefinish")))}function J(l,u){var g=q(u);return g&&(Se(l,u),u.pendingcb===0&&(u.finished=!0,l.emit("finish"))),g}function Ue(l,u,g){u.ending=!0,J(l,u),g&&(u.finished?i.nextTick(g):l.once("finish",g)),u.ended=!0,l.writable=!1}function xe(l,u,g){var _=l.entry;for(l.entry=null;_;){var D=_.callback;u.pendingcb--,D(g),_=_.next}u.corkedRequestsFree?u.corkedRequestsFree.next=l:u.corkedRequestsFree=l}return Object.defineProperty(E.prototype,"destroyed",{get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(l){this._writableState&&(this._writableState.destroyed=l)}}),E.prototype.destroy=y.destroy,E.prototype._undestroy=y.undestroy,E.prototype._destroy=function(l,u){this.end(),u(l)},Fe}var Ge,ht;function ce(){if(ht)return Ge;ht=1;var i=de,e=Object.keys||function(y){var O=[];for(var N in y)O.push(N);return O};Ge=p;var t=Object.create(x);t.inherits=ve;var r=Ut(),a=kt();t.inherits(p,r);for(var o=e(a.prototype),d=0;d<o.length;d++){var h=o[d];p.prototype[h]||(p.prototype[h]=a.prototype[h])}function p(y){if(!(this instanceof p))return new p(y);r.call(this,y),a.call(this,y),y&&y.readable===!1&&(this.readable=!1),y&&y.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,y&&y.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",C)}Object.defineProperty(p.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function C(){this.allowHalfOpen||this._writableState.ended||i.nextTick(v,this)}function v(y){y.end()}return Object.defineProperty(p.prototype,"destroyed",{get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(y){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=y,this._writableState.destroyed=y)}}),p.prototype._destroy=function(y,O){this.push(null),this.end(),i.nextTick(O,y)},Ge}var $e={},ft;function pt(){if(ft)return $e;ft=1;var i=ne.Buffer,e=i.isEncoding||function(c){switch(c=""+c,c&&c.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function t(c){if(!c)return"utf8";for(var m;;)switch(c){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return c;default:if(m)return;c=(""+c).toLowerCase(),m=!0}}function r(c){var m=t(c);if(typeof m!="string"&&(i.isEncoding===e||!e(c)))throw new Error("Unknown encoding: "+c);return m||c}$e.StringDecoder=a;function a(c){this.encoding=r(c);var m;switch(this.encoding){case"utf16le":this.text=y,this.end=O,m=4;break;case"utf8":this.fillLast=p,m=4;break;case"base64":this.text=N,this.end=R,m=3;break;default:this.write=E,this.end=W;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(m)}a.prototype.write=function(c){if(c.length===0)return"";var m,T;if(this.lastNeed){if(m=this.fillLast(c),m===void 0)return"";T=this.lastNeed,this.lastNeed=0}else T=0;return T<c.length?m?m+this.text(c,T):this.text(c,T):m||""},a.prototype.end=v,a.prototype.text=C,a.prototype.fillLast=function(c){if(this.lastNeed<=c.length)return c.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);c.copy(this.lastChar,this.lastTotal-this.lastNeed,0,c.length),this.lastNeed-=c.length};function o(c){return c<=127?0:c>>5===6?2:c>>4===14?3:c>>3===30?4:c>>6===2?-1:-2}function d(c,m,T){var k=m.length-1;if(k<T)return 0;var L=o(m[k]);return L>=0?(L>0&&(c.lastNeed=L-1),L):--k<T||L===-2?0:(L=o(m[k]),L>=0?(L>0&&(c.lastNeed=L-2),L):--k<T||L===-2?0:(L=o(m[k]),L>=0?(L>0&&(L===2?L=0:c.lastNeed=L-3),L):0))}function h(c,m,T){if((m[0]&192)!==128)return c.lastNeed=0,"�";if(c.lastNeed>1&&m.length>1){if((m[1]&192)!==128)return c.lastNeed=1,"�";if(c.lastNeed>2&&m.length>2&&(m[2]&192)!==128)return c.lastNeed=2,"�"}}function p(c){var m=this.lastTotal-this.lastNeed,T=h(this,c);if(T!==void 0)return T;if(this.lastNeed<=c.length)return c.copy(this.lastChar,m,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);c.copy(this.lastChar,m,0,c.length),this.lastNeed-=c.length}function C(c,m){var T=d(this,c,m);if(!this.lastNeed)return c.toString("utf8",m);this.lastTotal=T;var k=c.length-(T-this.lastNeed);return c.copy(this.lastChar,0,k),c.toString("utf8",m,k)}function v(c){var m=c&&c.length?this.write(c):"";return this.lastNeed?m+"�":m}function y(c,m){if((c.length-m)%2===0){var T=c.toString("utf16le",m);if(T){var k=T.charCodeAt(T.length-1);if(k>=55296&&k<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=c[c.length-2],this.lastChar[1]=c[c.length-1],T.slice(0,-1)}return T}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=c[c.length-1],c.toString("utf16le",m,c.length-1)}function O(c){var m=c&&c.length?this.write(c):"";if(this.lastNeed){var T=this.lastTotal-this.lastNeed;return m+this.lastChar.toString("utf16le",0,T)}return m}function N(c,m){var T=(c.length-m)%3;return T===0?c.toString("base64",m):(this.lastNeed=3-T,this.lastTotal=3,T===1?this.lastChar[0]=c[c.length-1]:(this.lastChar[0]=c[c.length-2],this.lastChar[1]=c[c.length-1]),c.toString("base64",m,c.length-T))}function R(c){var m=c&&c.length?this.write(c):"";return this.lastNeed?m+this.lastChar.toString("base64",0,3-this.lastNeed):m}function E(c){return c.toString(this.encoding)}function W(c){return c&&c.length?this.write(c):""}return $e}var Ye,gt;function Ut(){if(gt)return Ye;gt=1;var i=de;Ye=m;var e=Mr,t;m.ReadableState=c,Je().EventEmitter;var r=function(n,s){return n.listeners(s).length},a=Nt,o=ne.Buffer,d=Z.Uint8Array||function(){};function h(n){return o.from(n)}function p(n){return o.isBuffer(n)||n instanceof d}var C=Object.create(x);C.inherits=ve;var v=Ze,y=void 0;v&&v.debuglog?y=v.debuglog("stream"):y=function(){};var O=Xr(),N=Lt,R;C.inherits(m,a);var E=["error","close","destroy","pause","resume"];function W(n,s,f){if(typeof n.prependListener=="function")return n.prependListener(s,f);!n._events||!n._events[s]?n.on(s,f):e(n._events[s])?n._events[s].unshift(f):n._events[s]=[f,n._events[s]]}function c(n,s){t=t||ce(),n=n||{};var f=s instanceof t;this.objectMode=!!n.objectMode,f&&(this.objectMode=this.objectMode||!!n.readableObjectMode);var w=n.highWaterMark,I=n.readableHighWaterMark,S=this.objectMode?16:16*1024;w||w===0?this.highWaterMark=w:f&&(I||I===0)?this.highWaterMark=I:this.highWaterMark=S,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new O,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=n.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,n.encoding&&(R||(R=pt().StringDecoder),this.decoder=new R(n.encoding),this.encoding=n.encoding)}function m(n){if(t=t||ce(),!(this instanceof m))return new m(n);this._readableState=new c(n,this),this.readable=!0,n&&(typeof n.read=="function"&&(this._read=n.read),typeof n.destroy=="function"&&(this._destroy=n.destroy)),a.call(this)}Object.defineProperty(m.prototype,"destroyed",{get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(n){this._readableState&&(this._readableState.destroyed=n)}}),m.prototype.destroy=N.destroy,m.prototype._undestroy=N.undestroy,m.prototype._destroy=function(n,s){this.push(null),s(n)},m.prototype.push=function(n,s){var f=this._readableState,w;return f.objectMode?w=!0:typeof n=="string"&&(s=s||f.defaultEncoding,s!==f.encoding&&(n=o.from(n,s),s=""),w=!0),T(this,n,s,!1,w)},m.prototype.unshift=function(n){return T(this,n,null,!0,!1)};function T(n,s,f,w,I){var S=n._readableState;if(s===null)S.reading=!1,ae(n,S);else{var A;I||(A=L(S,s)),A?n.emit("error",A):S.objectMode||s&&s.length>0?(typeof s!="string"&&!S.objectMode&&Object.getPrototypeOf(s)!==o.prototype&&(s=h(s)),w?S.endEmitted?n.emit("error",new Error("stream.unshift() after end event")):k(n,S,s,!0):S.ended?n.emit("error",new Error("stream.push() after EOF")):(S.reading=!1,S.decoder&&!f?(s=S.decoder.write(s),S.objectMode||s.length!==0?k(n,S,s,!1):Se(n,S)):k(n,S,s,!1))):w||(S.reading=!1)}return $(S)}function k(n,s,f,w){s.flowing&&s.length===0&&!s.sync?(n.emit("data",f),n.read(0)):(s.length+=s.objectMode?1:f.length,w?s.buffer.unshift(f):s.buffer.push(f),s.needReadable&&q(n)),Se(n,s)}function L(n,s){var f;return!p(s)&&typeof s!="string"&&s!==void 0&&!n.objectMode&&(f=new TypeError("Invalid non-string/buffer chunk")),f}function $(n){return!n.ended&&(n.needReadable||n.length<n.highWaterMark||n.length===0)}m.prototype.isPaused=function(){return this._readableState.flowing===!1},m.prototype.setEncoding=function(n){return R||(R=pt().StringDecoder),this._readableState.decoder=new R(n),this._readableState.encoding=n,this};var Y=8388608;function X(n){return n>=Y?n=Y:(n--,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n++),n}function se(n,s){return n<=0||s.length===0&&s.ended?0:s.objectMode?1:n!==n?s.flowing&&s.length?s.buffer.head.data.length:s.length:(n>s.highWaterMark&&(s.highWaterMark=X(n)),n<=s.length?n:s.ended?s.length:(s.needReadable=!0,0))}m.prototype.read=function(n){y("read",n),n=parseInt(n,10);var s=this._readableState,f=n;if(n!==0&&(s.emittedReadable=!1),n===0&&s.needReadable&&(s.length>=s.highWaterMark||s.ended))return y("read: emitReadable",s.length,s.ended),s.length===0&&s.ended?K(this):q(this),null;if(n=se(n,s),n===0&&s.ended)return s.length===0&&K(this),null;var w=s.needReadable;y("need readable",w),(s.length===0||s.length-n<s.highWaterMark)&&(w=!0,y("length less than watermark",w)),s.ended||s.reading?(w=!1,y("reading or ended",w)):w&&(y("do read"),s.reading=!0,s.sync=!0,s.length===0&&(s.needReadable=!0),this._read(s.highWaterMark),s.sync=!1,s.reading||(n=se(f,s)));var I;return n>0?I=_(n,s):I=null,I===null?(s.needReadable=!0,n=0):s.length-=n,s.length===0&&(s.ended||(s.needReadable=!0),f!==n&&s.ended&&K(this)),I!==null&&this.emit("data",I),I};function ae(n,s){if(!s.ended){if(s.decoder){var f=s.decoder.end();f&&f.length&&(s.buffer.push(f),s.length+=s.objectMode?1:f.length)}s.ended=!0,q(n)}}function q(n){var s=n._readableState;s.needReadable=!1,s.emittedReadable||(y("emitReadable",s.flowing),s.emittedReadable=!0,s.sync?i.nextTick(_e,n):_e(n))}function _e(n){y("emit readable"),n.emit("readable"),g(n)}function Se(n,s){s.readingMore||(s.readingMore=!0,i.nextTick(J,n,s))}function J(n,s){for(var f=s.length;!s.reading&&!s.flowing&&!s.ended&&s.length<s.highWaterMark&&(y("maybeReadMore read 0"),n.read(0),f!==s.length);)f=s.length;s.readingMore=!1}m.prototype._read=function(n){this.emit("error",new Error("_read() is not implemented"))},m.prototype.pipe=function(n,s){var f=this,w=this._readableState;switch(w.pipesCount){case 0:w.pipes=n;break;case 1:w.pipes=[w.pipes,n];break;default:w.pipes.push(n);break}w.pipesCount+=1,y("pipe count=%d opts=%j",w.pipesCount,s);var I=(!s||s.end!==!1)&&n!==process.stdout&&n!==process.stderr,S=I?Ce:pe;w.endEmitted?i.nextTick(S):f.once("end",S),n.on("unpipe",A);function A(oe,ge){y("onunpipe"),oe===f&&ge&&ge.hasUnpiped===!1&&(ge.hasUnpiped=!0,$t())}function Ce(){y("onend"),n.end()}var Be=Ue(f);n.on("drain",Be);var tt=!1;function $t(){y("cleanup"),n.removeListener("close",je),n.removeListener("finish",Ve),n.removeListener("drain",Be),n.removeListener("error",He),n.removeListener("unpipe",A),f.removeListener("end",Ce),f.removeListener("end",pe),f.removeListener("data",rt),tt=!0,w.awaitDrain&&(!n._writableState||n._writableState.needDrain)&&Be()}var We=!1;f.on("data",rt);function rt(oe){y("ondata"),We=!1;var ge=n.write(oe);ge===!1&&!We&&((w.pipesCount===1&&w.pipes===n||w.pipesCount>1&&ee(w.pipes,n)!==-1)&&!tt&&(y("false write response, pause",f._readableState.awaitDrain),f._readableState.awaitDrain++,We=!0),f.pause())}function He(oe){y("onerror",oe),pe(),n.removeListener("error",He),r(n,"error")===0&&n.emit("error",oe)}W(n,"error",He);function je(){n.removeListener("finish",Ve),pe()}n.once("close",je);function Ve(){y("onfinish"),n.removeListener("close",je),pe()}n.once("finish",Ve);function pe(){y("unpipe"),f.unpipe(n)}return n.emit("pipe",f),w.flowing||(y("pipe resume"),f.resume()),n};function Ue(n){return function(){var s=n._readableState;y("pipeOnDrain",s.awaitDrain),s.awaitDrain&&s.awaitDrain--,s.awaitDrain===0&&r(n,"data")&&(s.flowing=!0,g(n))}}m.prototype.unpipe=function(n){var s=this._readableState,f={hasUnpiped:!1};if(s.pipesCount===0)return this;if(s.pipesCount===1)return n&&n!==s.pipes?this:(n||(n=s.pipes),s.pipes=null,s.pipesCount=0,s.flowing=!1,n&&n.emit("unpipe",this,f),this);if(!n){var w=s.pipes,I=s.pipesCount;s.pipes=null,s.pipesCount=0,s.flowing=!1;for(var S=0;S<I;S++)w[S].emit("unpipe",this,f);return this}var A=ee(s.pipes,n);return A===-1?this:(s.pipes.splice(A,1),s.pipesCount-=1,s.pipesCount===1&&(s.pipes=s.pipes[0]),n.emit("unpipe",this,f),this)},m.prototype.on=function(n,s){var f=a.prototype.on.call(this,n,s);if(n==="data")this._readableState.flowing!==!1&&this.resume();else if(n==="readable"){var w=this._readableState;!w.endEmitted&&!w.readableListening&&(w.readableListening=w.needReadable=!0,w.emittedReadable=!1,w.reading?w.length&&q(this):i.nextTick(xe,this))}return f},m.prototype.addListener=m.prototype.on;function xe(n){y("readable nexttick read 0"),n.read(0)}m.prototype.resume=function(){var n=this._readableState;return n.flowing||(y("resume"),n.flowing=!0,l(this,n)),this};function l(n,s){s.resumeScheduled||(s.resumeScheduled=!0,i.nextTick(u,n,s))}function u(n,s){s.reading||(y("resume read 0"),n.read(0)),s.resumeScheduled=!1,s.awaitDrain=0,n.emit("resume"),g(n),s.flowing&&!s.reading&&n.read(0)}m.prototype.pause=function(){return y("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(y("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function g(n){var s=n._readableState;for(y("flow",s.flowing);s.flowing&&n.read()!==null;);}m.prototype.wrap=function(n){var s=this,f=this._readableState,w=!1;n.on("end",function(){if(y("wrapped end"),f.decoder&&!f.ended){var A=f.decoder.end();A&&A.length&&s.push(A)}s.push(null)}),n.on("data",function(A){if(y("wrapped data"),f.decoder&&(A=f.decoder.write(A)),!(f.objectMode&&A==null)&&!(!f.objectMode&&(!A||!A.length))){var Ce=s.push(A);Ce||(w=!0,n.pause())}});for(var I in n)this[I]===void 0&&typeof n[I]=="function"&&(this[I]=function(A){return function(){return n[A].apply(n,arguments)}}(I));for(var S=0;S<E.length;S++)n.on(E[S],this.emit.bind(this,E[S]));return this._read=function(A){y("wrapped _read",A),w&&(w=!1,n.resume())},this},Object.defineProperty(m.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),m._fromList=_;function _(n,s){if(s.length===0)return null;var f;return s.objectMode?f=s.buffer.shift():!n||n>=s.length?(s.decoder?f=s.buffer.join(""):s.buffer.length===1?f=s.buffer.head.data:f=s.buffer.concat(s.length),s.buffer.clear()):f=D(n,s.buffer,s.decoder),f}function D(n,s,f){var w;return n<s.head.data.length?(w=s.head.data.slice(0,n),s.head.data=s.head.data.slice(n)):n===s.head.data.length?w=s.shift():w=f?P(n,s):V(n,s),w}function P(n,s){var f=s.head,w=1,I=f.data;for(n-=I.length;f=f.next;){var S=f.data,A=n>S.length?S.length:n;if(A===S.length?I+=S:I+=S.slice(0,n),n-=A,n===0){A===S.length?(++w,f.next?s.head=f.next:s.head=s.tail=null):(s.head=f,f.data=S.slice(A));break}++w}return s.length-=w,I}function V(n,s){var f=o.allocUnsafe(n),w=s.head,I=1;for(w.data.copy(f),n-=w.data.length;w=w.next;){var S=w.data,A=n>S.length?S.length:n;if(S.copy(f,f.length-n,0,A),n-=A,n===0){A===S.length?(++I,w.next?s.head=w.next:s.head=s.tail=null):(s.head=w,w.data=S.slice(A));break}++I}return s.length-=I,f}function K(n){var s=n._readableState;if(s.length>0)throw new Error('"endReadable()" called on non-empty stream');s.endEmitted||(s.ended=!0,i.nextTick(Q,s,n))}function Q(n,s){!n.endEmitted&&n.length===0&&(n.endEmitted=!0,s.readable=!1,s.emit("end"))}function ee(n,s){for(var f=0,w=n.length;f<w;f++)if(n[f]===s)return f;return-1}return Ye}var xt=z,Le=ce(),Bt=Object.create(x);Bt.inherits=ve;Bt.inherits(z,Le);function Jr(i,e){var t=this._transformState;t.transforming=!1;var r=t.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));t.writechunk=null,t.writecb=null,e!=null&&this.push(e),r(i);var a=this._readableState;a.reading=!1,(a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}function z(i){if(!(this instanceof z))return new z(i);Le.call(this,i),this._transformState={afterTransform:Jr.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,i&&(typeof i.transform=="function"&&(this._transform=i.transform),typeof i.flush=="function"&&(this._flush=i.flush)),this.on("prefinish",Qr)}function Qr(){var i=this;typeof this._flush=="function"?this._flush(function(e,t){mt(i,e,t)}):mt(this,null,null)}z.prototype.push=function(i,e){return this._transformState.needTransform=!1,Le.prototype.push.call(this,i,e)};z.prototype._transform=function(i,e,t){throw new Error("_transform() is not implemented")};z.prototype._write=function(i,e,t){var r=this._transformState;if(r.writecb=t,r.writechunk=i,r.writeencoding=e,!r.transforming){var a=this._readableState;(r.needTransform||a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}};z.prototype._read=function(i){var e=this._transformState;e.writechunk!==null&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};z.prototype._destroy=function(i,e){var t=this;Le.prototype._destroy.call(this,i,function(r){e(r),t.emit("close")})};function mt(i,e,t){if(e)return i.emit("error",e);if(t!=null&&i.push(t),i._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(i._transformState.transforming)throw new Error("Calling transform done when still transforming");return i.push(null)}var ei=be,Wt=xt,Ht=Object.create(x);Ht.inherits=ve;Ht.inherits(be,Wt);function be(i){if(!(this instanceof be))return new be(i);Wt.call(this,i)}be.prototype._transform=function(i,e,t){t(null,i)};(function(i,e){e=i.exports=Ut(),e.Stream=e,e.Readable=e,e.Writable=kt(),e.Duplex=ce(),e.Transform=xt,e.PassThrough=ei})(Rr,De);var ti=ii,ri=Object.prototype.hasOwnProperty;function ii(){for(var i={},e=0;e<arguments.length;e++){var t=arguments[e];for(var r in t)ri.call(t,r)&&(i[r]=t[r])}return i}var jt=De.Transform,Vt=ur.inherits,Kt=ti;function he(i){jt.call(this,i),this._destroyed=!1}Vt(he,jt);he.prototype.destroy=function(i){if(!this._destroyed){this._destroyed=!0;var e=this;process.nextTick(function(){i&&e.emit("error",i),e.emit("close")})}};function ni(i,e,t){t(null,i)}function et(i){return function(e,t,r){return typeof e=="function"&&(r=t,t=e,e={}),typeof t!="function"&&(t=ni),typeof r!="function"&&(r=null),i(e,t,r)}}Or.exports=et(function(i,e,t){var r=new he(i);return r._transform=e,t&&(r._flush=t),r});we.ctor=et(function(i,e,t){function r(a){if(!(this instanceof r))return new r(a);this.options=Kt(i,a),he.call(this,this.options)}return Vt(r,he),r.prototype._transform=e,t&&(r.prototype._flush=t),r});we.obj=et(function(i,e,t){var r=new he(Kt({objectMode:!0,highWaterMark:16},i));return r._transform=e,t&&(r._flush=t),r});Object.defineProperty(Me,"__esModule",{value:!0});Me.storeTransformStream=void 0;const si=we;function ai(i){return si.obj((e,t,r)=>{try{const a=i(e);r(null,a);return}catch(a){r(a);return}})}Me.storeTransformStream=ai;(function(i){var e=Z&&Z.__createBinding||(Object.create?function(r,a,o,d){d===void 0&&(d=o),Object.defineProperty(r,d,{enumerable:!0,get:function(){return a[o]}})}:function(r,a,o,d){d===void 0&&(d=o),r[d]=a[o]}),t=Z&&Z.__exportStar||function(r,a){for(var o in r)o!=="default"&&!Object.prototype.hasOwnProperty.call(a,o)&&e(a,r,o)};Object.defineProperty(i,"__esModule",{value:!0}),t(Re,i),t(Ie,i),t(Pe,i),t(fe,i),t(Me,i)})(ze);const me={GOOGLE:"google",FACEBOOK:"facebook",TWITCH:"twitch",REDDIT:"reddit",DISCORD:"discord"},re={GOOGLE:"google",FACEBOOK:"facebook",TWITCH:"twitch",REDDIT:"reddit",DISCORD:"discord",EMAIL_PASSWORDLESS:"torus-auth0-email-passwordless"},yt={[re.GOOGLE]:"tkey-google",[re.FACEBOOK]:"tkey-facebook",[re.TWITCH]:"tkey-twitch",[re.REDDIT]:"tkey-reddit",[re.DISCORD]:"tkey-discord",[re.EMAIL_PASSWORDLESS]:"tkey-auth0-email-passwordless"},U={MOONPAY:"moonpay",WYRE:"wyre",RAMPNETWORK:"rampnetwork",XANPOOL:"xanpool",MERCURYO:"mercuryo",TRANSAK:"transak",BANXA:"banxa"},B={MAINNET:"mainnet",MATIC:"matic",BSC_MAINNET:"bsc_mainnet",AVALANCHE_MAINNET:"avalanche_mainnet",XDAI:"xdai"},oi={PRODUCTION:"production",DEVELOPMENT:"development",BINANCE:"binance",TESTING:"testing",LRC:"lrc",BETA:"beta",BNB:"bnb",POLYGON:"polygon"},le={BOTTOM_LEFT:"bottom-left",TOP_LEFT:"top-left",BOTTOM_RIGHT:"bottom-right",TOP_RIGHT:"top-right"},li=["ETH","USDT","USDC","TUSD","EOSDT","USD","DAI","GUSD","DKKT","PAX","ILS","RUB","BYN","EUR","GBP","JPY","KRW","PLN","MXN","AUD","BRL","CAD","CHF","KPW","LAK","LBP","LKR","XOF","CNHT","DOGE","UAH","TRY","HKD","XJP","SGD","USC","NZD","NGN","RUR","COP","GHS","EGP","IDR","BHD","CRC","PEN","AED","DOP","PKR","HUF","VND","XAR","LTC","RON","OMR","MYR","DKK","UGX","ZMW","SAR","SEK","GEL","RWF","IRR","TZS","CNY","VEF","BDT","HRK","CLP","THB","XAF","ARS","UYU","SZL","KZT","NOK","KES","PAB","INR","CZK","MAD","TWD","PHP","ZAR","BOB","CDF","DASH","VES","ISK","MWK","BAM","TTD","XRP","JOD","RSD","HNL","BGN","GTQ","BWP","XMR","MMK","QAR","AOA","KWD","MUR","WUSD","WEUR","WAVES","WTRY","LRD","LSL","LYD","AWG","MDL","BTO","EURS","CHFT","MKD","MNT","MOP","MRO","MVR","VOLLAR","CKUSD","KHR","VUV","BITCNY","QC","BBD","NAD","NPR","PGK","PYG","BIF","BMD","BND","XLM","BNB","SCR","BAT","CRO","HT","KCS","LEO","LINK","MKR","NPXS","OMG","REP","ZB","ZIL","ZRX","BCH","BZD","CUP","CVE","DJF","DZD","ERN","ETB","FJD","FKP","BUSD","ANCT","ALL","AMD","ANG","CNYX","IQD","UZS","TND","GGP","XAU","KGS","GIP","JMD","ZEC","USDP","BSV","EMC2","SNT","GTO","POWR","EUSD","EURT","BCY","BTS","ATM","BLOCKPAY","ARDR","AMP","B2X","BITGOLD","BITEUR","ATB","BITUSD","AGRS","DFXT","HIKEN","BIX","KNC","EOS","COB","COSS","BMH","NANO","BDG","BNT","XVG","LKK1Y","LKK","USDK","EURN","NZDT","JSE","GMD","GNF","GYD","YER","XPF","HTG","SLL","SOS","WST","SVC","SYP","NEO","KMF","JUMP","AYA","BLAST","WGR","BCN","BTG","URALS","INN","USDQ","CNH","HUSD","BKRW","NZDX","EURX","CADX","USDEX","JPYX","AUDX","VNDC","EON","GBPX","CHFX","USDJ","IDRT","USDS","USDN","BIDR","IDK","BSD","BTN","KYD","NIO","SBD","SDG","SHP","TOP","XCD","XCHF","CNYT","GYEN","ZUSD","GOLD","TRX","TRYB","PLATC","STRAX","UST","GLM","VAI","BRZ","DDRST","XAUT","MIM"],ui={[U.MOONPAY]:["AUD","BGN","BRL","CAD","CHF","CNY","COP","CZK","DKK","DOP","EGP","EUR","GBP","HKD","HRK","IDR","ILS","JPY","JOD","KES","KRW","KWD","LKR","MAD","MXN","MYR","NGN","NOK","NZD","OMR","PEN","PKR","PLN","RON","RUB","SEK","SGD","THB","TRY","TWD","USD","VND","ZAR"],[U.WYRE]:["USD","EUR","GBP","AUD","CAD","NZD","ARS","BRL","CHF","CLP","COP","CZK","DKK","HKD","ILS","INR","ISK","JPY","KRW","MXN","MYR","NOK","PHP","PLN","SEK","THB","VND","ZAR"],[U.RAMPNETWORK]:["USD","EUR","GBP"],[U.XANPOOL]:["SGD","HKD","THB","PHP","INR","IDR","MYR","AUD","NZD","KRW"],[U.MERCURYO]:["EUR","USD","GBP","TRY","JPY","BRL","NGN","VND","MXN","KRW"],[U.TRANSAK]:["ARS","AUD","BBD","BGN","BMD","BRL","CAD","CHF","CLP","CRC","CZK","DKK","DOP","EUR","FJD","FKP","GBP","GIP","HRK","HUF","IDR","ILS","ISK","JMD","JPY","KES","KRW","MDL","MXN","MYR","NOK","NZD","PEN","PHP","PLN","PYG","RON","SEK","SGD","THB","TRY","TZS","USD","ZAR"],[U.BANXA]:["EUR","GBP","USD"]},di=new Set(li);function te(i){return ui[i].filter(t=>di.has(t))}const ci={[U.MOONPAY]:{line1:"Credit/ Debit Card/ Apple Pay",line2:"4.5% or 5 USD",line3:"2,000€/day, 10,000€/mo",supportPage:"https://help.moonpay.io/en/",minOrderValue:24.99,maxOrderValue:5e4,validCurrencies:te(U.MOONPAY),validCryptoCurrenciesByChain:{[B.MAINNET]:[{value:"aave",display:"AAVE"},{value:"bat",display:"BAT"},{value:"dai",display:"DAI"},{value:"eth",display:"ETH"},{value:"mkr",display:"MKR"},{value:"matic",display:"MATIC"},{value:"usdt",display:"USDT"},{value:"usdc",display:"USDC"}],[B.MATIC]:[{value:"eth_polygon",display:"ETH"},{value:"matic_polygon",display:"MATIC"},{value:"usdc_polygon",display:"USDC"}],[B.BSC_MAINNET]:[{value:"bnb_bsc",display:"BNB"},{value:"busd_bsc",display:"BUSD"}],[B.AVALANCHE_MAINNET]:[{value:"avax_cchain",display:"AVAX"}]},includeFees:!0,api:!0,enforceMax:!1},[U.WYRE]:{line1:"Apple Pay/ Debit/ Credit Card",line2:"4.9% + 30¢ or 5 USD",line3:"$250/day",supportPage:"https://support.sendwyre.com/en/",minOrderValue:5,maxOrderValue:500,validCurrencies:te(U.WYRE),validCryptoCurrenciesByChain:{[B.MAINNET]:[{value:"AAVE",display:"AAVE"},{value:"BAT",display:"BAT"},{value:"BUSD",display:"BUSD"},{value:"DAI",display:"DAI"},{value:"ETH",display:"ETH"},{value:"MKR",display:"MKR"},{value:"UNI",display:"UNI"},{value:"USDC",display:"USDC"},{value:"USDT",display:"USDT"}],[B.MATIC]:[{value:"MUSDC",display:"USDC"}],[B.AVALANCHE_MAINNET]:[{value:"AVAXC",display:"AVAXC"}]},includeFees:!1,api:!0,enforceMax:!1},[U.RAMPNETWORK]:{line1:"Debit Card/ <br>Apple Pay/ Bank transfer",line2:"0.49% - 2.9%",line3:"5,000€/purchase, 20,000€/mo",supportPage:"https://instant.ramp.network/",minOrderValue:50,maxOrderValue:2e4,validCurrencies:te(U.RAMPNETWORK),validCryptoCurrenciesByChain:{[B.MAINNET]:[{value:"ETH",display:"ETH"},{value:"DAI",display:"DAI"},{value:"USDC",display:"USDC"},{value:"USDT",display:"USDT"}],[B.MATIC]:[{value:"MATIC_DAI",display:"DAI"},{value:"MATIC_MATIC",display:"MATIC"},{value:"MATIC_USDC",display:"USDC"}],[B.AVALANCHE_MAINNET]:[{value:"AVAX",display:"AVAX"}]},includeFees:!0,api:!0,receiveHint:"walletTopUp.receiveHintRamp",enforceMax:!1},[U.XANPOOL]:{line1:"PayNow/ InstaPay/ FPS/ GoJekPay/ UPI/ PromptPay/ <br>ViettelPay/ DuitNow",line2:"2.5% buying, 3% selling",line3:"$2,500 / day",supportPage:"mailto:support@xanpool.com",minOrderValue:100,maxOrderValue:2500,validCurrencies:te(U.XANPOOL),validCryptoCurrenciesByChain:{[B.MAINNET]:[{value:"ETH",display:"ETH"},{value:"USDT",display:"USDT"}]},includeFees:!0,api:!0,sell:!0,enforceMax:!1},[U.MERCURYO]:{line1:"Credit/ Debit Card/ Apple Pay",line2:"3.95% or 4 USD",line3:"10,000€/day, 25,000€/mo",supportPage:"mailto:support@mercuryo.io",minOrderValue:30,maxOrderValue:5e3,validCurrencies:te(U.MERCURYO),validCryptoCurrenciesByChain:{[B.MAINNET]:[{value:"ETH",display:"ETH"},{value:"BAT",display:"BAT"},{value:"USDT",display:"USDT"},{value:"DAI",display:"DAI"}],[B.BSC_MAINNET]:[{value:"BNB",display:"BNB"},{value:"BUSD",display:"BUSD"},{value:"1INCH",display:"1INCH"}]},includeFees:!0,api:!0,enforceMax:!1},[U.TRANSAK]:{line1:"Apple & Google Pay / Credit/Debit Card<br/>Bangkok Bank Mobile & iPay<br/>Bank Transfer (sepa/gbp) / SCB Mobile & Easy",line2:"0.99% - 5.5% or 5 USD",line3:"$5,000/day, $28,000/mo",supportPage:"https://support.transak.com/hc/en-US",minOrderValue:30,maxOrderValue:500,validCurrencies:te(U.TRANSAK),validCryptoCurrenciesByChain:{[B.MAINNET]:[{value:"AAVE",display:"AAVE"},{value:"DAI",display:"DAI"},{value:"ETH",display:"ETH"},{value:"USDC",display:"USDC"},{value:"USDT",display:"USDT"}],[B.MATIC]:[{value:"AAVE",display:"AAVE"},{value:"DAI",display:"DAI"},{value:"MATIC",display:"MATIC"},{value:"USDC",display:"USDC"},{value:"USDT",display:"USDT"},{value:"WETH",display:"WETH"}],[B.BSC_MAINNET]:[{value:"BNB",display:"BNB"},{value:"BUSD",display:"BUSD"}],[B.AVALANCHE_MAINNET]:[{value:"AVAX",display:"AVAX"}]},includeFees:!0,enforceMax:!0},[U.BANXA]:{line1:"Debit Card/ <br>Apple Pay/ Bank transfer",line2:"0.49% - 2.9%",line3:"5,000€/purchase, 20,000€/mo",supportPage:"https://support.banxa.com",minOrderValue:20,maxOrderValue:15e3,validCurrencies:te(U.BANXA),validCryptoCurrenciesByChain:{[B.MAINNET]:[{value:"ETH",display:"ETH"},{value:"USDT",display:"USDT"},{value:"BUSD",display:"BUSD"},{value:"LINK",display:"LINK"},{value:"USDC",display:"USDC"},{value:"CHZ",display:"CHZ"},{value:"BAT",display:"BAT"},{value:"MANA",display:"MANA"},{value:"AAVE",display:"AAVE"},{value:"COMP",display:"COMP"},{value:"ENJ",display:"ENJ"}],[B.MATIC]:[{value:"MATIC",display:"MATIC"}]},includeFees:!0,enforceMax:!0}},hi={en:{embed:{continue:"Continue",actionRequired:"Authorization required",pendingAction:"Click continue to proceed with your request in a popup",cookiesRequired:"Cookies Required",enableCookies:"Please enable cookies in your browser preferences to access Torus",clickHere:"More Info"}},de:{embed:{continue:"Fortsetzen",actionRequired:"Autorisierung erforderlich",pendingAction:"Klicken Sie in einem Popup auf Weiter, um mit Ihrer Anfrage fortzufahren",cookiesRequired:"Cookies benötigt",enableCookies:"Bitte aktivieren Sie Cookies in Ihren Browsereinstellungen, um auf Torus zuzugreifen",clickHere:"Mehr Info"}},ja:{embed:{continue:"継続する",actionRequired:"認証が必要です",pendingAction:"続行をクリックして、ポップアップでリクエストを続行します",cookiesRequired:"必要なクッキー",enableCookies:"Torusにアクセスするには、ブラウザの設定でCookieを有効にしてください。",clickHere:"詳しくは"}},ko:{embed:{continue:"계속하다",actionRequired:"승인 필요",pendingAction:"팝업에서 요청을 진행하려면 계속을 클릭하십시오.",cookiesRequired:"쿠키 필요",enableCookies:"브라우저 환경 설정에서 쿠키를 활성화하여 Torus에 액세스하십시오.",clickHere:"더 많은 정보"}},zh:{embed:{continue:"继续",actionRequired:"需要授权",pendingAction:"单击继续以在弹出窗口中继续您的请求",cookiesRequired:"必填Cookie",enableCookies:"请在您的浏览器首选项中启用cookie以访问Torus。",clickHere:"更多信息"}}};var G={supportedVerifierList:Object.values(re),paymentProviders:ci,api:"https://api.tor.us",translations:hi,prodTorusUrl:"",localStorageKeyPrefix:"torus-"};const wt=i=>new Promise((e,t)=>{window.document.body!=null?Promise.resolve(i()).then(e).catch(t):window.document.addEventListener("DOMContentLoaded",()=>{Promise.resolve(i()).then(e).catch(t)})}),ye=i=>{const e=window.document.createElement("template"),t=i.trim();return e.innerHTML=t,e.content.firstChild},fi=function(i,e,t){for(var r=arguments.length,a=new Array(r>3?r-3:0),o=3;o<r;o++)a[o-3]=arguments[o];const d=()=>{t(...a),i.removeEventListener(e,d)};i.addEventListener(e,d)},F=(i,e,t)=>{const r=a=>{t(a),i.removeListener(e,r)};i.on(e,r)};async function pi(){return new Promise(i=>{document.readyState!=="loading"?i():fi(document,"DOMContentLoaded",i)})}var M=Xt.getLogger("torus-embed"),j={errors:{disconnected:()=>"Torus: Lost connection to Torus.",permanentlyDisconnected:()=>"Torus: Disconnected from iframe. Page reload required.",sendSiteMetadata:()=>"Torus: Failed to send site metadata. This is an internal error, please report this bug.",unsupportedSync:i=>`Torus: The Torus Ethereum provider does not support synchronous methods like ${i} without a callback parameter.`,invalidDuplexStream:()=>"Must provide a Node.js-style duplex stream.",invalidOptions:(i,e)=>`Invalid options. Received: { maxEventListeners: ${i}, shouldSendMetadata: ${e} }`,invalidRequestArgs:()=>"Expected a single, non-array, object argument.",invalidRequestMethod:()=>"'args.method' must be a non-empty string.",invalidRequestParams:()=>"'args.params' must be an object or array if provided.",invalidLoggerObject:()=>"'args.logger' must be an object if provided.",invalidLoggerMethod:i=>`'args.logger' must include required method '${i}'.`},info:{connected:i=>`Torus: Connected to chain with ID "${i}".`},warnings:{enableDeprecation:'Torus: ""ethereum.enable()" is deprecated and may be removed in the future. Please use "ethereum.send("eth_requestAccounts")" instead. For more information, see: https://eips.ethereum.org/EIPS/eip-1102',sendDeprecation:`Torus: "ethereum.send(...)" is deprecated and may be removed in the future. Please use "ethereum.sendAsync(...)" or "ethereum.request(...)" instead.
For more information, see: https://eips.ethereum.org/EIPS/eip-1193`,events:{close:`Torus: The event "close" is deprecated and may be removed in the future. Please use "disconnect" instead.
For more information, see: https://eips.ethereum.org/EIPS/eip-1193`,data:`Torus: The event "data" is deprecated and will be removed in the future.Use "message" instead.
For more information, see: https://eips.ethereum.org/EIPS/eip-1193#message`,networkChanged:`Torus: The event "networkChanged" is deprecated and may be removed in the future. Please use "chainChanged" instead.
For more information, see: https://eips.ethereum.org/EIPS/eip-1193`,notification:`Torus: The event "notification" is deprecated and may be removed in the future. Please use "message" instead.
For more information, see: https://eips.ethereum.org/EIPS/eip-1193`},publicConfigStore:'Torus: The property "publicConfigStore" is deprecated and WILL be removed in the future.'}};const{paymentProviders:bt}=G,gi=(i,e)=>{const t={};if(!i)return{errors:t,isValid:!0};if(i&&!bt[i])return t.provider="Invalid Provider",{errors:t,isValid:Object.keys(t).length===0};const r=bt[i],a=e||{};if(a.fiatValue){const o=+parseFloat(a.fiatValue.toString())||0;o<r.minOrderValue&&(t.fiatValue="Requested amount is lower than supported"),o>r.maxOrderValue&&r.enforceMax&&(t.fiatValue="Requested amount is higher than supported")}if(a.selectedCurrency&&!r.validCurrencies.includes(a.selectedCurrency)&&(t.selectedCurrency="Unsupported currency"),a.selectedCryptoCurrency){const o=Object.values(r.validCryptoCurrenciesByChain).flat().map(h=>h.value),d=i===U.MOONPAY?a.selectedCryptoCurrency.toLowerCase():a.selectedCryptoCurrency;o&&!o.includes(d)&&(t.selectedCryptoCurrency="Unsupported cryptoCurrency")}return{errors:t,isValid:Object.keys(t).length===0}};function mi(){return(i,e,t)=>{(typeof i.method!="string"||!i.method)&&(e.error=ue.ethErrors.rpc.invalidRequest({message:"The request 'method' must be a non-empty string.",data:i})),t(r=>{const{error:a}=e;return a&&M.error(`MetaMask - RPC Error: ${a.message}`,a),r()})}}function vt(i,e,t){let r=`MetaMask: Lost connection to "${i}".`;e!=null&&e.stack&&(r+=`
${e.stack}`),M.warn(r),t&&t.listenerCount("error")>0&&t.emit("error",r)}const ie=()=>Math.random().toString(36).slice(2),qt=async(i,e)=>{let t,r;const a="1.38.6";let o=e.version||a;try{if((i==="binance"||i==="production")&&!e.version){let d;G.prodTorusUrl?d={data:G.prodTorusUrl}:d=await Mt(`${G.api}/latestversion?name=@toruslabs/torus-embed&version=${a}`,{},{useAPIKey:!0}),o=d.data,G.prodTorusUrl=d.data}}catch(d){M.error(d,"unable to fetch latest version")}switch(M.info("version used: ",o),i){case"binance":t=`https://binance.tor.us/v${o}`,r="info";break;case"testing":t="https://testing.tor.us",r="debug";break;case"bnb":t="https://bnb.tor.us",r="error";break;case"polygon":t="https://polygon.tor.us",r="error";break;case"lrc":t="https://lrc.tor.us",r="debug";break;case"beta":t="https://beta.tor.us",r="debug";break;case"development":t="http://localhost:4050",r="debug";break;default:t=`https://app.tor.us/v${o}`,r="error";break}return{torusUrl:t,logLevel:r}},_t=()=>{let i=window.navigator.language||"en-US";const e=i.split("-");return i=Object.prototype.hasOwnProperty.call(G.translations,e[0])?e[0]:"en",i},yi=["eth_subscription"],Ft=()=>{},St="directories=0,titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=660,width=375",wi="directories=0,titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=740,width=1315",Ct="directories=0,titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=700,width=450";function bi(){const i=window.screenLeft!==void 0?window.screenLeft:window.screenX,e=window.screenTop!==void 0?window.screenTop:window.screenY,t=1200,r=700,a=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:window.screen.width,o=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:window.screen.height,d=1,h=Math.abs((a-t)/2/d+i),p=Math.abs((o-r)/2/d+e);return`titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=${r/d},width=${t/d},top=${p},left=${h}`}function Et(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),t.push.apply(t,r)}return t}function vi(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Et(Object(t),!0).forEach(function(r){b(i,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):Et(Object(t)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(t,r))})}return i}Pt.defaultMaxListeners=100;const Tt=function(i,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return(r,a)=>r||a.error?e(r||a.error):!t||Array.isArray(a)?i(a):i(a.result)};class ke extends Pt{constructor(e){let{maxEventListeners:t=100,shouldSendMetadata:r=!0,jsonRpcStreamName:a="provider"}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(super(),b(this,"chainId",void 0),b(this,"selectedAddress",void 0),b(this,"_rpcEngine",void 0),b(this,"networkVersion",void 0),b(this,"shouldSendMetadata",void 0),b(this,"isTorus",void 0),b(this,"_publicConfigStore",void 0),b(this,"tryPreopenHandle",void 0),b(this,"enable",void 0),b(this,"_state",void 0),b(this,"_jsonRpcConnection",void 0),b(this,"_sentWarnings",{enable:!1,experimentalMethods:!1,send:!1,publicConfigStore:!1,events:{close:!1,data:!1,networkChanged:!1,notification:!1}}),!cr.duplex(e))throw new Error(j.errors.invalidDuplexStream());this.isTorus=!0,this.setMaxListeners(t),this._state=vi({},ke._defaultState),this.selectedAddress=null,this.networkVersion=null,this.chainId=null,this.shouldSendMetadata=r,this._handleAccountsChanged=this._handleAccountsChanged.bind(this),this._handleChainChanged=this._handleChainChanged.bind(this),this._handleUnlockStateChanged=this._handleUnlockStateChanged.bind(this),this._handleConnect=this._handleConnect.bind(this),this._handleDisconnect=this._handleDisconnect.bind(this),this._handleStreamDisconnect=this._handleStreamDisconnect.bind(this),this._sendSync=this._sendSync.bind(this),this._rpcRequest=this._rpcRequest.bind(this),this._warnOfDeprecation=this._warnOfDeprecation.bind(this),this._initializeState=this._initializeState.bind(this),this.request=this.request.bind(this),this.send=this.send.bind(this),this.sendAsync=this.sendAsync.bind(this);const o=new zt;Ke(e,o,e,this._handleStreamDisconnect.bind(this,"MetaMask")),this._publicConfigStore=new ze.ObservableStore({storageKey:"Metamask-Config"}),Ke(o.createStream("publicConfig"),ze.storeAsStream(this._publicConfigStore),vt.bind(this,"MetaMask PublicConfigStore")),o.ignoreStream("phishing"),this.on("connect",()=>{this._state.isConnected=!0});const d=Zt();Ke(d.stream,o.createStream(a),d.stream,this._handleStreamDisconnect.bind(this,"MetaMask RpcProvider"));const h=new Jt;h.push(Qt()),h.push(mi()),h.push(d.middleware),this._rpcEngine=h,d.events.on("notification",p=>{const{method:C,params:v}=p;C==="wallet_accountsChanged"?this._handleAccountsChanged(v):C==="wallet_unlockStateChanged"?this._handleUnlockStateChanged(v):C==="wallet_chainChanged"?this._handleChainChanged(v):yi.includes(p.method)&&(this.emit("data",p),this.emit("notification",v.result),this.emit("message",{type:C,data:v}))})}get publicConfigStore(){return this._sentWarnings.publicConfigStore||(M.warn(j.warnings.publicConfigStore),this._sentWarnings.publicConfigStore=!0),this._publicConfigStore}isConnected(){return this._state.isConnected}async request(e){if(!e||typeof e!="object"||Array.isArray(e))throw ue.ethErrors.rpc.invalidRequest({message:j.errors.invalidRequestArgs(),data:e});const{method:t,params:r}=e;if(typeof t!="string"||t.length===0)throw ue.ethErrors.rpc.invalidRequest({message:j.errors.invalidRequestMethod(),data:e});if(r!==void 0&&!Array.isArray(r)&&(typeof r!="object"||r===null))throw ue.ethErrors.rpc.invalidRequest({message:j.errors.invalidRequestParams(),data:e});return new Promise((a,o)=>{this._rpcRequest({method:t,params:r},Tt(a,o))})}sendAsync(e,t){this._rpcRequest(e,t)}addListener(e,t){return this._warnOfDeprecation(e),super.addListener(e,t)}on(e,t){return this._warnOfDeprecation(e),super.on(e,t)}once(e,t){return this._warnOfDeprecation(e),super.once(e,t)}prependListener(e,t){return this._warnOfDeprecation(e),super.prependListener(e,t)}prependOnceListener(e,t){return this._warnOfDeprecation(e),super.prependOnceListener(e,t)}async _initializeState(){try{const{accounts:e,chainId:t,isUnlocked:r,networkVersion:a}=await this.request({method:"wallet_getProviderState"});this.emit("connect",{chainId:t}),this._handleChainChanged({chainId:t,networkVersion:a}),this._handleUnlockStateChanged({accounts:e,isUnlocked:r}),this._handleAccountsChanged(e)}catch(e){M.error("MetaMask: Failed to get initial state. Please report this bug.",e)}finally{M.info("initialized state"),this._state.initialized=!0,this.emit("_initialized")}}_rpcRequest(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=t;const o=e;if(!Array.isArray(o)){if(o.jsonrpc||(o.jsonrpc="2.0"),o.method==="eth_accounts"||o.method==="eth_requestAccounts")a=(d,h)=>{this._handleAccountsChanged(h.result||[],o.method==="eth_accounts",r),t(d,h)};else if(o.method==="wallet_getProviderState"){this._rpcEngine.handle(e,a);return}}this.tryPreopenHandle(o,a)}send(e,t){return this._sentWarnings.send||(M.warn(j.warnings.sendDeprecation),this._sentWarnings.send=!0),typeof e=="string"&&(!t||Array.isArray(t))?new Promise((r,a)=>{try{this._rpcRequest({method:e,params:t},Tt(r,a,!1))}catch(o){a(o)}}):e&&typeof e=="object"&&typeof t=="function"?this._rpcRequest(e,t):this._sendSync(e)}_sendSync(e){let t;switch(e.method){case"eth_accounts":t=this.selectedAddress?[this.selectedAddress]:[];break;case"eth_coinbase":t=this.selectedAddress||null;break;case"eth_uninstallFilter":this._rpcRequest(e,Ft),t=!0;break;case"net_version":t=this.networkVersion||null;break;default:throw new Error(j.errors.unsupportedSync(e.method))}return{id:e.id,jsonrpc:e.jsonrpc,result:t}}_handleConnect(e){this._state.isConnected||(this._state.isConnected=!0,this.emit("connect",{chainId:e}),M.debug(j.info.connected(e)))}_handleDisconnect(e,t){if(this._state.isConnected||!this._state.isPermanentlyDisconnected&&!e){this._state.isConnected=!1;let r;e?(r=new ue.EthereumRpcError(1013,t||j.errors.disconnected()),M.debug(r)):(r=new ue.EthereumRpcError(1011,t||j.errors.permanentlyDisconnected()),M.error(r),this.chainId=null,this._state.accounts=null,this.selectedAddress=null,this._state.isUnlocked=!1,this._state.isPermanentlyDisconnected=!0),this.emit("disconnect",r)}}_handleStreamDisconnect(e,t){vt(e,t,this),this._handleDisconnect(!1,t?t.message:void 0)}_handleAccountsChanged(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=e;Array.isArray(a)||(M.error("MetaMask: Received non-array accounts parameter. Please report this bug.",a),a=[]);for(const o of e)if(typeof o!="string"){M.error("MetaMask: Received non-string account. Please report this bug.",e),a=[];break}hr(this._state.accounts,a)||(t&&Array.isArray(this._state.accounts)&&this._state.accounts.length>0&&!r&&M.error('MetaMask: "eth_accounts" unexpectedly updated accounts. Please report this bug.',a),this._state.accounts=a,this.emit("accountsChanged",a)),this.selectedAddress!==a[0]&&(this.selectedAddress=a[0]||null)}_handleChainChanged(){let{chainId:e,networkVersion:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!e||!t){M.error("MetaMask: Received invalid network parameters. Please report this bug.",{chainId:e,networkVersion:t});return}t==="loading"?this._handleDisconnect(!0):(this._handleConnect(e),e!==this.chainId&&(this.chainId=e,this._state.initialized&&this.emit("chainChanged",this.chainId)))}_handleUnlockStateChanged(){let{accounts:e,isUnlocked:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(typeof t!="boolean"){M.error("MetaMask: Received invalid isUnlocked parameter. Please report this bug.",{isUnlocked:t});return}t!==this._state.isUnlocked&&(this._state.isUnlocked=t,this._handleAccountsChanged(e||[]))}_warnOfDeprecation(e){this._sentWarnings.events[e]===!1&&(M.warn(j.warnings.events[e]),this._sentWarnings.events[e]=!0)}}b(ke,"_defaultState",{accounts:null,isConnected:!1,isUnlocked:!1,initialized:!1,isPermanentlyDisconnected:!1,hasEmittedConnection:!1});const _i=i=>({algorithms:i.algorithms||["sha256"],delimiter:i.delimiter||" ",full:i.full||!1}),Si=(i,e)=>{const t={};return i.algorithms.forEach(r=>{t[r]=dr(r).update(e,"utf8").digest("base64")}),t},Ci=(i,e)=>{let t="";return t+=Object.keys(e.hashes).map(r=>`${r}-${e.hashes[r]}`).join(i.delimiter),t},Ei=(i,e)=>{const t=_i(i),r={hashes:Si(t,e),integrity:void 0};return r.integrity=Ci(t,r),t.full?r:r.integrity};class At extends rr.EventEmitter{constructor(e){let{url:t,target:r,features:a}=e;super(),b(this,"url",void 0),b(this,"target",void 0),b(this,"features",void 0),b(this,"window",void 0),b(this,"windowTimer",void 0),b(this,"iClosedWindow",void 0),this.url=t,this.target=r||"_blank",this.features=a||bi(),this.window=void 0,this.windowTimer=void 0,this.iClosedWindow=!1,this._setupTimer()}_setupTimer(){this.windowTimer=Number(setInterval(()=>{this.window&&this.window.closed&&(clearInterval(this.windowTimer),this.iClosedWindow||this.emit("close"),this.iClosedWindow=!1,this.window=void 0),this.window===void 0&&clearInterval(this.windowTimer)},500))}open(){var e;return this.window=window.open(this.url.href,this.target,this.features),(e=this.window)!==null&&e!==void 0&&e.focus&&this.window.focus(),Promise.resolve()}close(){this.iClosedWindow=!0,this.window&&this.window.close()}redirect(e){e?window.location.replace(this.url.href):window.location.href=this.url.href}}function Dt(i){return new Promise((e,t)=>{try{const r=document.createElement("img");r.onload=()=>e(!0),r.onerror=()=>e(!1),r.src=i}catch(r){t(r)}})}const Ti=i=>{const{document:e}=i,t=e.querySelector('head > meta[property="og:site_name"]');if(t)return t.content;const r=e.querySelector('head > meta[name="title"]');return r?r.content:e.title&&e.title.length>0?e.title:i.location.hostname};async function Ai(i){const{document:e}=i;let t=e.querySelector('head > link[rel="shortcut icon"]');return t&&await Dt(t.href)||(t=Array.from(e.querySelectorAll('head > link[rel="icon"]')).find(r=>Boolean(r.href)),t&&await Dt(t.href))?t.href:null}const Di=async()=>({name:Ti(window),icon:await Ai(window)});async function Oi(i){try{const e=await Di();i.handle({jsonrpc:"2.0",id:ie(),method:"wallet_sendDomainMetadata",params:e},Ft)}catch(e){M.error({message:j.errors.sendSiteMetadata(),originalError:e})}}const Ri=["host","chainId","networkName"];function Ot(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),t.push.apply(t,r)}return t}function Ii(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ot(Object(t),!0).forEach(function(r){b(i,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):Ot(Object(t)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(t,r))})}return i}const Pi={[me.GOOGLE]:!0,[me.FACEBOOK]:!0,[me.REDDIT]:!0,[me.TWITCH]:!0,[me.DISCORD]:!0},Gt="sha384-rKDzAQGTjTTHTfXsCxsUa85RHvDNSPuZxXAKdVdBqxl8Oad3Fn3uvFruOKq1pLhx",Mi="max-age=3600",Ni=["eth_sendTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","personal_sign","eth_getEncryptionPublicKey","eth_decrypt"];(async function(){try{if(typeof document>"u")return;const e=document.createElement("link"),{torusUrl:t}=await qt("production",{check:!1,hash:Gt,version:""});e.href=`${t}/popup`,e.crossOrigin="anonymous",e.type="text/html",e.rel="prefetch",e.relList&&e.relList.supports&&e.relList.supports("prefetch")&&document.head.appendChild(e)}catch(e){M.warn(e)}})();class Li{constructor(){let{buttonPosition:e=le.BOTTOM_LEFT,buttonSize:t=56,modalZIndex:r=99999,apiKey:a="torus-default"}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};b(this,"buttonPosition",le.BOTTOM_LEFT),b(this,"buttonSize",void 0),b(this,"torusUrl",void 0),b(this,"torusIframe",void 0),b(this,"styleLink",void 0),b(this,"isLoggedIn",void 0),b(this,"isInitialized",void 0),b(this,"torusWidgetVisibility",void 0),b(this,"torusAlert",void 0),b(this,"apiKey",void 0),b(this,"modalZIndex",void 0),b(this,"alertZIndex",void 0),b(this,"torusAlertContainer",void 0),b(this,"isIframeFullScreen",void 0),b(this,"whiteLabel",void 0),b(this,"requestedVerifier",void 0),b(this,"currentVerifier",void 0),b(this,"embedTranslations",void 0),b(this,"ethereum",void 0),b(this,"provider",void 0),b(this,"communicationMux",void 0),b(this,"isLoginCallback",void 0),b(this,"paymentProviders",G.paymentProviders),b(this,"loginHint",""),b(this,"useWalletConnect",void 0),b(this,"isCustomLogin",!1),this.buttonPosition=e,this.buttonSize=t,this.torusUrl="",this.isLoggedIn=!1,this.isInitialized=!1,this.torusWidgetVisibility=!0,this.requestedVerifier="",this.currentVerifier="",this.apiKey=a,ir(a),this.modalZIndex=r,this.alertZIndex=r+1e3,this.isIframeFullScreen=!1}async init(){let{buildEnv:e=oi.PRODUCTION,enableLogging:t=!1,enabledVerifiers:r=Pi,network:a={host:"mainnet",chainId:null,networkName:"",blockExplorer:"",ticker:"",tickerName:""},loginConfig:o={},showTorusButton:d=!0,integrity:h={check:!1,hash:Gt,version:""},whiteLabel:p,skipTKey:C=!1,useWalletConnect:v=!1,mfaLevel:y="default"}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.isInitialized)throw new Error("Already initialized");const{torusUrl:O,logLevel:N}=await qt(e,h);M.info(O,"url loaded"),this.torusUrl=O,this.whiteLabel=p,this.useWalletConnect=v,this.isCustomLogin=!!(o&&Object.keys(o).length>0)||!!(p&&Object.keys(p).length>0),M.setDefaultLevel(N),t?M.enableAll():M.disableAll(),this.torusWidgetVisibility=d;const R=new URL(O);R.pathname.endsWith("/")?R.pathname+="popup":R.pathname+="/popup",R.hash=`#isCustomLogin=${this.isCustomLogin}`,this.torusIframe=ye(`<iframe
        id="torusIframe"
        allow=${v?"camera":""}
        class="torusIframe"
        src="${R.href}"
        style="display: none; position: fixed; top: 0; right: 0; width: 100%; color-scheme: none;
        height: 100%; border: none; border-radius: 0; z-index: ${this.modalZIndex}"
      ></iframe>`),this.torusAlertContainer=ye('<div id="torusAlertContainer"></div>'),this.torusAlertContainer.style.display="none",this.torusAlertContainer.style.setProperty("z-index",this.alertZIndex.toString());const E=window.document.createElement("link");E.setAttribute("rel","stylesheet"),E.setAttribute("type","text/css"),E.setAttribute("href",`${O}/css/widget.css`),this.styleLink=E;const{defaultLanguage:W=_t(),customTranslations:c={}}=this.whiteLabel||{},T=er(G.translations,c)[W]||G.translations[_t()];this.embedTranslations=T.embed;const k=async()=>(await pi(),new Promise((L,$)=>{this.torusIframe.onload=async()=>{this._setupWeb3();const Y=this.communicationMux.getStream("init_stream");Y.on("data",X=>{const{name:se,data:ae,error:q}=X;se==="init_complete"&&ae.success?(this.isInitialized=!0,this._displayIframe(this.isIframeFullScreen),L(void 0)):q&&$(new Error(q))}),Y.write({name:"init_stream",data:{enabledVerifiers:r,loginConfig:o,whiteLabel:this.whiteLabel,buttonPosition:this.buttonPosition,buttonSize:this.buttonSize,torusWidgetVisibility:this.torusWidgetVisibility,apiKey:this.apiKey,skipTKey:C,network:a,mfaLevel:y}})},window.document.head.appendChild(this.styleLink),window.document.body.appendChild(this.torusIframe),window.document.body.appendChild(this.torusAlertContainer)}));if(e==="production"&&h.check){const L=`${O}/popup`,$=await fetch(L,{cache:"reload"});if($.headers.get("Cache-Control")!==Mi)throw new Error(`Unexpected Cache-Control headers, got ${$.headers.get("Cache-Control")}`);const Y=await $.text(),X=Ei({algorithms:["sha384"]},Y);if(M.info(X,"integrity"),X===h.hash)await k();else throw this.clearInit(),new Error("Integrity check failed")}else await k()}login(){let{verifier:e="",login_hint:t=""}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.isInitialized)throw new Error("Call init() first");return this.requestedVerifier=e,this.loginHint=t,this.ethereum.enable()}logout(){return new Promise((e,t)=>{if(!this.isLoggedIn){t(new Error("User has not logged in yet"));return}this.communicationMux.getStream("logout").write({name:"logOut"});const a=this.communicationMux.getStream("status");F(a,"data",d=>{d.loggedIn?t(new Error("Some Error Occured")):(this.isLoggedIn=!1,this.currentVerifier="",this.requestedVerifier="",e())})})}async cleanUp(){this.isLoggedIn&&await this.logout(),this.clearInit()}clearInit(){function e(t){return t instanceof Element||t instanceof HTMLDocument}e(this.styleLink)&&window.document.body.contains(this.styleLink)&&(this.styleLink.remove(),this.styleLink=void 0),e(this.torusIframe)&&window.document.body.contains(this.torusIframe)&&(this.torusIframe.remove(),this.torusIframe=void 0),e(this.torusAlertContainer)&&window.document.body.contains(this.torusAlertContainer)&&(this.torusAlert=void 0,this.torusAlertContainer.remove(),this.torusAlertContainer=void 0),this.isInitialized=!1}hideTorusButton(){this.torusWidgetVisibility=!1,this._sendWidgetVisibilityStatus(!1),this._displayIframe()}showTorusButton(){this.torusWidgetVisibility=!0,this._sendWidgetVisibilityStatus(!0),this._displayIframe()}setProvider(e){let{host:t="mainnet",chainId:r=null,networkName:a=""}=e,o=pr(e,Ri);return new Promise((d,h)=>{const p=this.communicationMux.getStream("provider_change");F(p,"data",y=>{const{err:O,success:N}=y.data;M.info(y),O?h(O):N?d():h(new Error("some error occured"))});const v=ie();this._handleWindow(v,{target:"_blank",features:St}),p.write({name:"show_provider_change",data:{network:Ii({host:t,chainId:r,networkName:a},o),preopenInstanceId:v,override:!1}})})}showWallet(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=this.communicationMux.getStream("show_wallet"),a=e?`/${e}`:"";r.write({name:"show_wallet",data:{path:a}}),F(r,"data",d=>{if(d.name==="show_wallet_instance"){const{instanceId:h}=d.data,p=new URL(`${this.torusUrl}/wallet${a}`);p.searchParams.append("integrity","true"),p.searchParams.append("instanceId",h),Object.keys(t).forEach(v=>{p.searchParams.append(v,t[v])}),p.hash=`#isCustomLogin=${this.isCustomLogin}`,new At({url:p,features:wi}).open()}})}async getPublicAddress(e){let{verifier:t,verifierId:r,isExtended:a=!1}=e;if(!G.supportedVerifierList.includes(t)||!yt[t])throw new Error("Unsupported verifier");const o=t,d=yt[t],h=new URL("https://api.tor.us/lookup/torus");return h.searchParams.append("verifier",d),h.searchParams.append("verifierId",r),h.searchParams.append("walletVerifier",o),h.searchParams.append("network","mainnet"),h.searchParams.append("isExtended",a.toString()),Mt(h.href,{headers:{"Content-Type":"application/json; charset=utf-8"}},{useAPIKey:!0})}getUserInfo(e){return new Promise((t,r)=>{if(this.isLoggedIn){const a=this.communicationMux.getStream("user_info_access");a.write({name:"user_info_access_request"}),F(a,"data",d=>{const{name:h,data:{approved:p,payload:C,rejected:v,newRequest:y}}=d;if(h==="user_info_access_response"){if(p)t(C);else if(v)r(new Error("User rejected the request"));else if(y){const O=this.communicationMux.getStream("user_info");F(O,"data",E=>{E.name==="user_info_response"&&(E.data.approved?t(E.data.payload):r(new Error("User rejected the request")))});const R=ie();this._handleWindow(R,{target:"_blank",features:St}),O.write({name:"user_info_request",data:{message:e,preopenInstanceId:R}})}}})}else r(new Error("User has not logged in yet"))})}initiateTopup(e,t){return new Promise((r,a)=>{if(this.isInitialized){const{errors:o,isValid:d}=gi(e,t);if(!d){a(new Error(JSON.stringify(o)));return}const h=this.communicationMux.getStream("topup");F(h,"data",v=>{v.name==="topup_response"&&(v.data.success?r(v.data.success):a(new Error(v.data.error)))});const C=ie();this._handleWindow(C),h.write({name:"topup_request",data:{provider:e,params:t,preopenInstanceId:C}})}else a(new Error("Torus is not initialized yet"))})}async loginWithPrivateKey(e){const{privateKey:t,userInfo:r}=e;return new Promise((a,o)=>{if(this.isInitialized){if(Buffer.from(t,"hex").length!==32){o(new Error("Invalid private key, Please provide a 32 byte valid secp25k1 private key"));return}const d=this.communicationMux.getStream("login_with_private_key");F(d,"data",p=>{p.name==="login_with_private_key_response"&&(p.data.success?a(p.data.success):o(new Error(p.data.error)))}),d.write({name:"login_with_private_key_request",data:{privateKey:t,userInfo:r}})}else o(new Error("Torus is not initialized yet"))})}async showWalletConnectScanner(){if(!this.useWalletConnect)throw new Error("Set `useWalletConnect` as true in init function options to use wallet connect scanner");return new Promise((e,t)=>{if(this.isLoggedIn){const r=this.communicationMux.getStream("wallet_connect_stream");F(r,"data",o=>{o.name==="wallet_connect_stream_res"&&(o.data.success?e(o.data.success):t(new Error(o.data.error)),this._displayIframe())}),r.write({name:"wallet_connect_stream_req"}),this._displayIframe(!0)}else t(new Error("User has not logged in yet"))})}_handleWindow(e){let{url:t,target:r,features:a}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e){const o=this.communicationMux.getStream("window"),d=new URL(t||`${this.torusUrl}/redirect?preopenInstanceId=${e}`);d.hash?d.hash+=`&isCustomLogin=${this.isCustomLogin}`:d.hash=`#isCustomLogin=${this.isCustomLogin}`;const h=new At({url:d,target:r,features:a});if(h.open(),!h.window){this._createPopupBlockAlert(e,d.href);return}o.write({name:"opened_window",data:{preopenInstanceId:e}});const p=C=>{let{preopenInstanceId:v,close:y}=C;v===e&&y&&(h.close(),o.removeListener("data",p))};o.on("data",p),h.once("close",()=>{o.write({data:{preopenInstanceId:e,closed:!0}}),o.removeListener("data",p)})}}_setEmbedWhiteLabel(e){const{theme:t}=this.whiteLabel||{};if(t){const{isDark:r=!1,colors:a={}}=t;r&&e.classList.add("torus-dark"),a.torusBrand1&&e.style.setProperty("--torus-brand-1",a.torusBrand1),a.torusGray2&&e.style.setProperty("--torus-gray-2",a.torusGray2)}}_getLogoUrl(){var e,t;let r=`${this.torusUrl}/images/torus_icon-blue.svg`;if((e=this.whiteLabel)!==null&&e!==void 0&&(t=e.theme)!==null&&t!==void 0&&t.isDark){var a;r=((a=this.whiteLabel)===null||a===void 0?void 0:a.logoLight)||r}else{var o;r=((o=this.whiteLabel)===null||o===void 0?void 0:o.logoDark)||r}return r}_sendWidgetVisibilityStatus(e){this.communicationMux.getStream("torus-widget-visibility").write({data:e})}_displayIframe(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t={},r=this.buttonSize+14;if(e)t.display="block",t.width="100%",t.height="100%",t.top="0px",t.right="0px",t.left="0px",t.bottom="0px";else switch(t.display=this.torusWidgetVisibility?"block":"none",t.height=`${r}px`,t.width=`${r}px`,this.buttonPosition){case le.TOP_LEFT:t.top="0px",t.left="0px",t.right="auto",t.bottom="auto";break;case le.TOP_RIGHT:t.top="0px",t.right="0px",t.left="auto",t.bottom="auto";break;case le.BOTTOM_RIGHT:t.bottom="0px",t.right="0px",t.top="auto",t.left="auto";break;case le.BOTTOM_LEFT:default:t.bottom="0px",t.left="0px",t.top="auto",t.right="auto";break}Object.assign(this.torusIframe.style,t),this.isIframeFullScreen=e}_setupWeb3(){M.info("setupWeb3 running");const e=new it({name:"embed_metamask",target:"iframe_metamask",targetWindow:this.torusIframe.contentWindow,targetOrigin:new URL(this.torusUrl).origin}),t=new it({name:"embed_comm",target:"iframe_comm",targetWindow:this.torusIframe.contentWindow,targetOrigin:new URL(this.torusUrl).origin}),r=new ke(e),a=v=>{const y=r[v];r[v]=function(N){if(N&&N==="eth_requestAccounts")return r.enable();for(var R=arguments.length,E=new Array(R>1?R-1:0),W=1;W<R;W++)E[W-1]=arguments[W];return y.apply(this,[N,...E])}};a("send"),a("sendAsync"),r.enable=()=>new Promise((v,y)=>{r.sendAsync({jsonrpc:"2.0",id:ie(),method:"eth_requestAccounts",params:[]},(O,N)=>{const{result:R}=N||{};if(O)setTimeout(()=>{y(O)},50);else if(Array.isArray(R)&&R.length>0){const E=()=>{if(this.requestedVerifier!==""&&this.currentVerifier!==this.requestedVerifier){const{requestedVerifier:W}=this;this.logout().then(c=>{this.requestedVerifier=W,this._showLoginPopup(!0,v,y)}).catch(c=>y(c))}else v(R)};this.isLoggedIn?E():this.isLoginCallback=E}else this._showLoginPopup(!0,v,y)})}),r.tryPreopenHandle=(v,y)=>{const O=v;if(!Array.isArray(O)&&Ni.includes(O.method)){const N=ie();this._handleWindow(N,{target:"_blank",features:Ct}),O.preopenInstanceId=N}r._rpcEngine.handle(O,y)};const o=new Proxy(r,{deleteProperty:()=>!0});this.ethereum=o;const d=tr(t);this.communicationMux=d,d.getStream("window").on("data",v=>{v.name==="create_window"&&this._createPopupBlockAlert(v.data.preopenInstanceId,v.data.url)}),d.getStream("widget").on("data",v=>{const{data:y}=v;this._displayIframe(y)}),d.getStream("status").on("data",v=>{v.loggedIn?(this.isLoggedIn=v.loggedIn,this.currentVerifier=v.verifier):this._displayIframe(),this.isLoginCallback&&(this.isLoginCallback(),delete this.isLoginCallback)}),this.provider=o,this.provider.shouldSendMetadata&&Oi(this.provider._rpcEngine),r._initializeState(),M.debug("Torus - injected provider")}_showLoginPopup(e,t,r){const a=d=>{const{err:h,selectedAddress:p}=d;h?(M.error(h),r&&r(h)):t&&t([p]),this.isIframeFullScreen&&this._displayIframe()},o=this.communicationMux.getStream("oauth");if(!this.requestedVerifier)this._displayIframe(!0),F(o,"data",a),o.write({name:"oauth_modal",data:{calledFromEmbed:e}});else{F(o,"data",a);const d=ie();this._handleWindow(d),o.write({name:"oauth",data:{calledFromEmbed:e,verifier:this.requestedVerifier,preopenInstanceId:d,login_hint:this.loginHint}})}}_createPopupBlockAlert(e,t){const r=this._getLogoUrl(),a=ye(`<div id="torusAlert" class="torus-alert--v2"><div id="torusAlert__logo"><img src="${r}" /></div><div><h1 id="torusAlert__title">${this.embedTranslations.actionRequired}</h1><p id="torusAlert__desc">${this.embedTranslations.pendingAction}</p></div></div>`),o=ye(`<div><a id="torusAlert__btn">${this.embedTranslations.continue}</a></div>`),d=ye('<div id="torusAlert__btn-container"></div>');d.appendChild(o),a.appendChild(d);const h=()=>{o.addEventListener("click",()=>{this._handleWindow(e,{url:t,target:"_blank",features:Ct}),a.remove(),this.torusAlertContainer.children.length===0&&(this.torusAlertContainer.style.display="none")})};this._setEmbedWhiteLabel(a),wt(()=>{this.torusAlertContainer.style.display="block",this.torusAlertContainer.appendChild(a)}),wt(h)}}function Rt(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),t.push.apply(t,r)}return t}function Xe(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Rt(Object(t),!0).forEach(function(r){b(i,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):Rt(Object(t)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(t,r))})}return i}class Hi extends fr{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),b(this,"name",Ee.TORUS_EVM),b(this,"adapterNamespace",nr.EIP155),b(this,"currentChainNamespace",nt.EIP155),b(this,"type",sr.EXTERNAL),b(this,"status",H.NOT_READY),b(this,"torusInstance",null),b(this,"torusWalletOptions",void 0),b(this,"initParams",void 0),b(this,"loginSettings",{}),b(this,"rehydrated",!1),this.torusWalletOptions=e.adapterSettings||{},this.initParams=e.initParams||{},this.loginSettings=e.loginSettings||{},this.chainConfig=e.chainConfig||null,this.sessionTime=e.sessionTime||86400}get provider(){return this.status===H.CONNECTED&&this.torusInstance?this.torusInstance.provider:null}set provider(e){throw new Error("Not implemented")}async init(e){super.checkInitializationRequirements();let t;if(this.chainConfig){const{chainId:r,blockExplorer:a,displayName:o,rpcTarget:d,ticker:h,tickerName:p}=this.chainConfig;t={chainId:Number.parseInt(r,16),host:d,blockExplorer:a,networkName:o,ticker:h,tickerName:p}}else{this.chainConfig=ar(nt.EIP155,1);const{blockExplorer:r,displayName:a,chainId:o,ticker:d,tickerName:h}=this.chainConfig;t={chainId:Number.parseInt(o,16),host:"mainnet",blockExplorer:r,networkName:a,ticker:d,tickerName:h}}this.torusInstance=new Li(this.torusWalletOptions),qe.debug("initializing torus evm adapter init"),await this.torusInstance.init(Xe(Xe({showTorusButton:!1},this.initParams),{},{network:t})),this.status=H.READY,this.emit(Te.READY,Ee.TORUS_EVM);try{qe.debug("initializing torus evm adapter"),e.autoConnect&&(this.rehydrated=!0,await this.connect())}catch(r){qe.error("Failed to connect with torus evm provider",r),this.emit(Te.ERRORED,r)}}async connect(){if(super.checkConnectionRequirements(),!this.torusInstance)throw Ae.notReady("Torus wallet is not initialized");this.status=H.CONNECTING,this.emit(Te.CONNECTING,{adapter:Ee.TORUS_EVM});try{await this.torusInstance.login(this.loginSettings);const{chainId:e}=this.torusInstance.provider;if(e&&parseInt(e)!==parseInt(this.chainConfig.chainId,16)){const{chainId:t,blockExplorer:r,displayName:a,rpcTarget:o,ticker:d,tickerName:h}=this.chainConfig,p={chainId:Number.parseInt(t,16),host:o,blockExplorer:r,networkName:a,tickerName:h,ticker:d};await this.torusInstance.setProvider(Xe({},p));const C=await this.torusInstance.ethereum.request({method:"eth_chainId"});if(C&&parseInt(C)!==parseInt(this.chainConfig.chainId,16))throw Ae.fromCode(5e3,"Not connected to correct chainId. Expected: ".concat(this.chainConfig.chainId,", Current: ").concat(C))}return this.status=H.CONNECTED,this.torusInstance.showTorusButton(),this.emit(H.CONNECTED,{adapter:Ee.TORUS_EVM,reconnected:this.rehydrated}),this.provider}catch(e){throw this.status=H.READY,this.rehydrated=!1,this.emit(H.ERRORED,e),e instanceof or?e:st.connectionError("Failed to login with torus wallet")}}async disconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{cleanup:!1};if(!this.torusInstance)throw Ae.notReady("Torus wallet is not initialized");await super.disconnect(),await this.torusInstance.logout(),this.torusInstance.hideTorusButton(),e.cleanup?(this.status=H.NOT_READY,this.torusInstance=null):this.status=H.READY,this.rehydrated=!1,this.emit(Te.DISCONNECTED)}async getUserInfo(){if(this.status!==H.CONNECTED)throw st.notConnectedError("Not connected with wallet");if(!this.torusInstance)throw Ae.notReady("Torus wallet is not initialized");return await this.torusInstance.getUserInfo("")}setAdapterSettings(e){this.status!==H.READY&&e!=null&&e.sessionTime&&(this.sessionTime=e.sessionTime)}}export{Hi as TorusWalletAdapter};
